diff --git a/facebook/build.gradle b/facebook/build.gradle
index dd8c50bff..c529bdb1c 100644
--- a/facebook/build.gradle
+++ b/facebook/build.gradle
@@ -8,11 +8,13 @@ project.group = 'com.facebook.android'
 
 dependencies {
     // Facbook Dependancies
-    compile 'com.android.support:support-v4:23.0.1'
-    compile 'com.parse.bolts:bolts-android:1.2.1'
+    compile 'com.android.support:support-v4:(23,24]'
+    compile 'com.android.support:cardview-v7:(23,24]'
+    compile 'com.parse.bolts:bolts-tasks:1.3.0'
+    compile 'com.parse.bolts:bolts-applinks:1.3.0'
 
     // Unit Tests
-    testCompile 'com.android.support:appcompat-v7:23.0.1'
+    testCompile 'com.android.support:appcompat-v7:(23,24]'
 
     testCompile 'junit:junit:4.12'
     testCompile 'org.robolectric:robolectric:3.0'
@@ -35,9 +37,14 @@ android {
     buildToolsVersion '22.0.1'
 
     defaultConfig {
+<<<<<<< HEAD
         minSdkVersion 9
         targetSdkVersion 22
         multiDexEnabled true
+=======
+        minSdkVersion Integer.parseInt(project.ANDROID_BUILD_MIN_SDK_VERSION)
+        targetSdkVersion Integer.parseInt(project.ANDROID_BUILD_TARGET_SDK_VERSION)
+>>>>>>> sdk-version-4.10.0
     }
 
     lintOptions {
diff --git a/facebook/src/androidTest/java/com/facebook/BatchRequestTests.java b/facebook/src/androidTest/java/com/facebook/BatchRequestTests.java
index 362199031..135225b40 100644
--- a/facebook/src/androidTest/java/com/facebook/BatchRequestTests.java
+++ b/facebook/src/androidTest/java/com/facebook/BatchRequestTests.java
@@ -44,7 +44,7 @@ protected void setUp() throws Exception {
 
     protected String[] getDefaultPermissions()
     {
-        return new String[] { "email", "publish_actions", "read_stream" };
+        return new String[] { "email", "publish_actions", "user_posts" };
     };
 
     @LargeTest
diff --git a/facebook/src/androidTest/java/com/facebook/GraphRequestTests.java b/facebook/src/androidTest/java/com/facebook/GraphRequestTests.java
index 64bffef2c..6745a0fab 100644
--- a/facebook/src/androidTest/java/com/facebook/GraphRequestTests.java
+++ b/facebook/src/androidTest/java/com/facebook/GraphRequestTests.java
@@ -32,7 +32,7 @@
 
     protected String[] getDefaultPermissions()
     {
-        return new String[] { "email", "publish_actions", "read_stream" };
+        return new String[] { "email", "publish_actions", "user_posts" };
     };
 
     @LargeTest
diff --git a/facebook/src/androidTest/java/com/facebook/RequestTests.java b/facebook/src/androidTest/java/com/facebook/RequestTests.java
index 2d9952bf0..61f0c5547 100644
--- a/facebook/src/androidTest/java/com/facebook/RequestTests.java
+++ b/facebook/src/androidTest/java/com/facebook/RequestTests.java
@@ -63,7 +63,7 @@
         return new String[] {
                 "email",
                 "publish_actions",
-                "read_stream",
+                "user_posts",
                 "user_photos",
                 "user_videos" };
     };
diff --git a/facebook/src/main/java/com/facebook/AccessToken.java b/facebook/src/main/java/com/facebook/AccessToken.java
index 668be1a04..523b34c6f 100644
--- a/facebook/src/main/java/com/facebook/AccessToken.java
+++ b/facebook/src/main/java/com/facebook/AccessToken.java
@@ -156,11 +156,23 @@ public static void setCurrentAccessToken(AccessToken accessToken) {
     /**
      * Updates the current access token with up to date permissions,
      * and extends the expiration date, if extension is possible.
-     *
-     * This function must be run from the UI thread.
      */
     public static void refreshCurrentAccessTokenAsync() {
-        AccessTokenManager.getInstance().refreshCurrentAccessToken();
+        AccessTokenManager.getInstance().refreshCurrentAccessToken(null);
+    }
+
+    /**
+     * Updates the current access token with up to date permissions,
+     * and extends the expiration date, if extension is possible.
+     * @param callback
+     */
+    public static void refreshCurrentAccessTokenAsync(AccessTokenRefreshCallback callback) {
+        AccessTokenManager.getInstance().refreshCurrentAccessToken(callback);
+    }
+
+    public interface AccessTokenRefreshCallback {
+        void OnTokenRefreshed(AccessToken accessToken);
+        void OnTokenRefreshFailed(FacebookException exception);
     }
 
     /**
diff --git a/facebook/src/main/java/com/facebook/AccessTokenManager.java b/facebook/src/main/java/com/facebook/AccessTokenManager.java
index 82ee6014f..6171527d7 100644
--- a/facebook/src/main/java/com/facebook/AccessTokenManager.java
+++ b/facebook/src/main/java/com/facebook/AccessTokenManager.java
@@ -147,7 +147,7 @@ void extendAccessTokenIfNeeded() {
         if (!shouldExtendAccessToken()) {
             return;
         }
-        refreshCurrentAccessToken();
+        refreshCurrentAccessToken(null);
     }
 
     private boolean shouldExtendAccessToken() {
@@ -194,31 +194,38 @@ private static GraphRequest createExtendAccessTokenRequest(
         public int expiresAt;
     }
 
-    void refreshCurrentAccessToken() {
+    void refreshCurrentAccessToken(final AccessToken.AccessTokenRefreshCallback callback) {
         if (Looper.getMainLooper().equals(Looper.myLooper())) {
-            refreshCurrentAccessTokenImpl();
+            refreshCurrentAccessTokenImpl(callback);
         } else {
             Handler mainHandler = new Handler(Looper.getMainLooper());
             mainHandler.post(new Runnable() {
                 @Override
                 public void run() {
-                    refreshCurrentAccessTokenImpl();
+                    refreshCurrentAccessTokenImpl(callback);
                 }
             });
         }
     }
 
-    private void refreshCurrentAccessTokenImpl() {
+    private void refreshCurrentAccessTokenImpl(
+            final AccessToken.AccessTokenRefreshCallback callback) {
         final AccessToken accessToken = currentAccessToken;
         if (accessToken == null) {
+            if (callback != null) {
+                callback.OnTokenRefreshFailed(
+                        new FacebookException("No current access token to refresh"));
+            }
             return;
         }
         if (!tokenRefreshInProgress.compareAndSet(false, true)) {
+            if (callback != null) {
+                callback.OnTokenRefreshFailed(
+                        new FacebookException("Refresh already in progress"));
+            }
             return;
         }
 
-        Validate.runningOnUiThread();
-
         lastAttemptedTokenExtendDate = new Date();
 
         final Set<String> permissions = new HashSet<>();
@@ -276,18 +283,27 @@ public void onCompleted(GraphResponse response) {
         batch.addCallback(new GraphRequestBatch.Callback() {
             @Override
             public void onBatchCompleted(GraphRequestBatch batch) {
-                if (getInstance().getCurrentAccessToken() == null ||
-                        getInstance().getCurrentAccessToken().getUserId()
-                                != accessToken.getUserId()) {
-                    return;
-                }
+                AccessToken newAccessToken = null;
                 try {
+                    if (getInstance().getCurrentAccessToken() == null ||
+                            getInstance().getCurrentAccessToken().getUserId()
+                                    != accessToken.getUserId()) {
+                        if (callback != null) {
+                            callback.OnTokenRefreshFailed(
+                                    new FacebookException("No current access token to refresh"));
+                        }
+                        return;
+                    }
                     if (permissionsCallSucceeded.get() == false &&
                             refreshResult.accessToken == null &&
                             refreshResult.expiresAt == 0) {
+                        if (callback != null) {
+                            callback.OnTokenRefreshFailed(
+                                    new FacebookException("Failed to refresh access token"));
+                        }
                         return;
                     }
-                    AccessToken newAccessToken = new AccessToken(
+                    newAccessToken = new AccessToken(
                             refreshResult.accessToken != null ? refreshResult.accessToken :
                                     accessToken.getToken(),
                             accessToken.getApplicationId(),
@@ -305,6 +321,9 @@ public void onBatchCompleted(GraphRequestBatch batch) {
                     getInstance().setCurrentAccessToken(newAccessToken);
                 } finally {
                     tokenRefreshInProgress.set(false);
+                    if (callback != null && newAccessToken != null) {
+                        callback.OnTokenRefreshed(newAccessToken);
+                    }
                 }
             }
         });
diff --git a/facebook/src/main/java/com/facebook/AccessTokenSource.java b/facebook/src/main/java/com/facebook/AccessTokenSource.java
index 76dbbdebf..622c3fe5d 100644
--- a/facebook/src/main/java/com/facebook/AccessTokenSource.java
+++ b/facebook/src/main/java/com/facebook/AccessTokenSource.java
@@ -57,7 +57,11 @@
     /**
      * Indicates an access token constructed with a Client Token.
      */
-    CLIENT_TOKEN(true);
+    CLIENT_TOKEN(true),
+    /**
+     * Indicates an access token constructed from facebook.com/device
+     */
+    DEVICE_AUTH(true);
 
     private final boolean canExtendToken;
 
diff --git a/facebook/src/main/java/com/facebook/FacebookActivity.java b/facebook/src/main/java/com/facebook/FacebookActivity.java
index 825ac86b0..5b5c85fb6 100644
--- a/facebook/src/main/java/com/facebook/FacebookActivity.java
+++ b/facebook/src/main/java/com/facebook/FacebookActivity.java
@@ -110,4 +110,8 @@ private void handlePassThroughError() {
         setResult(RESULT_CANCELED, resultIntent);
         finish();
     }
+
+    public Fragment getCurrentFragment() {
+        return singleFragment;
+    }
 }
diff --git a/facebook/src/main/java/com/facebook/FacebookButtonBase.java b/facebook/src/main/java/com/facebook/FacebookButtonBase.java
index 1e3e1295a..fedb3a94f 100644
--- a/facebook/src/main/java/com/facebook/FacebookButtonBase.java
+++ b/facebook/src/main/java/com/facebook/FacebookButtonBase.java
@@ -69,6 +69,8 @@ protected FacebookButtonBase(
         configureButton(context, attrs, defStyleAttr, defStyleRes);
         this.analyticsButtonCreatedEventName = analyticsButtonCreatedEventName;
         this.analyticsButtonTappedEventName = analyticsButtonTappedEventName;
+        setClickable(true);
+        setFocusable(true);
     }
 
     protected abstract int getDefaultRequestCode();
@@ -336,7 +338,7 @@ private void parseTextAttributes(
                 defStyleAttr,
                 defStyleRes);
         try {
-            setTextColor(colorAttrs.getColor(0, Color.WHITE));
+            setTextColor(colorAttrs.getColorStateList(0));
         } finally {
             colorAttrs.recycle();
         }
diff --git a/facebook/src/main/java/com/facebook/FacebookSdk.java b/facebook/src/main/java/com/facebook/FacebookSdk.java
index 1fa687221..a5c42eb2b 100644
--- a/facebook/src/main/java/com/facebook/FacebookSdk.java
+++ b/facebook/src/main/java/com/facebook/FacebookSdk.java
@@ -162,7 +162,7 @@ public static synchronized void sdkInitialize(
             throw new FacebookException(CALLBACK_OFFSET_NEGATIVE);
         }
         FacebookSdk.callbackRequestCodeOffset = callbackRequestCodeOffset;
-        sdkInitialize(applicationContext);
+        sdkInitialize(applicationContext, callback);
     }
 
     /**
@@ -202,6 +202,11 @@ public static synchronized void sdkInitialize(
 
         // Make sure we've loaded default settings if we haven't already.
         FacebookSdk.loadDefaultsFromMetadata(FacebookSdk.applicationContext);
+
+        // Set sdkInitialized to true now so the bellow async tasks don't throw not initialized
+        // exceptions.
+        sdkInitialized = true;
+
         // Load app settings from network so that dialog configs are available
         Utility.loadAppSettingsAsync(FacebookSdk.applicationContext, applicationId);
         // Fetch available protocol versions from the apps on the device
@@ -237,8 +242,6 @@ public Void call() throws Exception {
                     }
                 });
         getExecutor().execute(accessTokenLoadFutureTask);
-
-        sdkInitialized = true;
     }
 
     /**
diff --git a/facebook/src/main/java/com/facebook/FacebookSdkVersion.java b/facebook/src/main/java/com/facebook/FacebookSdkVersion.java
index 51feaf4c4..e07120ccd 100644
--- a/facebook/src/main/java/com/facebook/FacebookSdkVersion.java
+++ b/facebook/src/main/java/com/facebook/FacebookSdkVersion.java
@@ -21,5 +21,5 @@
 package com.facebook;
 
 final class FacebookSdkVersion {
-    public static final String BUILD = "4.8.1";
+    public static final String BUILD = "4.10.0";
 }
diff --git a/facebook/src/main/java/com/facebook/GraphRequest.java b/facebook/src/main/java/com/facebook/GraphRequest.java
index 3cbd1ba1d..7552030a7 100644
--- a/facebook/src/main/java/com/facebook/GraphRequest.java
+++ b/facebook/src/main/java/com/facebook/GraphRequest.java
@@ -2182,11 +2182,6 @@ public void writeContentUri(String key, Uri contentUri, String mimeType)
             }
             writeContentDisposition(key, key, mimeType);
 
-            InputStream inputStream = FacebookSdk
-                    .getApplicationContext()
-                    .getContentResolver()
-                    .openInputStream(contentUri);
-
             int totalBytes = 0;
             if (outputStream instanceof ProgressNoopOutputStream) {
                 // If we are only counting bytes then skip reading the file
@@ -2194,6 +2189,10 @@ public void writeContentUri(String key, Uri contentUri, String mimeType)
 
                 ((ProgressNoopOutputStream) outputStream).addProgress(contentSize);
             } else {
+                InputStream inputStream = FacebookSdk
+                        .getApplicationContext()
+                        .getContentResolver()
+                        .openInputStream(contentUri);
                 totalBytes += Utility.copyAndCloseInputStream(inputStream, outputStream);
             }
 
diff --git a/facebook/src/main/java/com/facebook/appevents/AppEventsConstants.java b/facebook/src/main/java/com/facebook/appevents/AppEventsConstants.java
index 826d0285c..060b05964 100644
--- a/facebook/src/main/java/com/facebook/appevents/AppEventsConstants.java
+++ b/facebook/src/main/java/com/facebook/appevents/AppEventsConstants.java
@@ -81,10 +81,13 @@
     public static final String EVENT_NAME_ADDED_PAYMENT_INFO = "fb_mobile_add_payment_info";
 
     /**
-     * Log this event when the user has completed a purchase. The {@link
-     * AppEventsLogger#logPurchase(java.math.BigDecimal, java.util.Currency)} method is a shortcut
-     * for logging this event.
+     *  @deprecated Use {@link
+     *  AppEventsLogger#logPurchase(java.math.BigDecimal, java.util.Currency)} instead.
+     *  Log this event when the user has completed a purchase. The {@link
+     *  AppEventsLogger#logPurchase(java.math.BigDecimal, java.util.Currency)} method is a shortcut
+     *  for logging this event.
      */
+    @Deprecated
     public static final String EVENT_NAME_PURCHASED = "fb_mobile_purchase";
 
     // Gaming related
diff --git a/facebook/src/main/java/com/facebook/appevents/AppEventsLogger.java b/facebook/src/main/java/com/facebook/appevents/AppEventsLogger.java
index 515bab251..5b9d2aa4a 100644
--- a/facebook/src/main/java/com/facebook/appevents/AppEventsLogger.java
+++ b/facebook/src/main/java/com/facebook/appevents/AppEventsLogger.java
@@ -558,6 +558,7 @@ public void logPurchase(BigDecimal purchaseAmount, Currency currency) {
      *                       have no more than 24 entries, and keys should be mostly consistent from
      *                       one purchase event to the next.
      */
+    @SuppressWarnings("deprecation")
     public void logPurchase(BigDecimal purchaseAmount, Currency currency, Bundle parameters) {
 
         if (purchaseAmount == null) {
@@ -1159,7 +1160,7 @@ public static String getAnonymousAppDeviceGUID(Context context) {
     //
 
 
-    static class SessionEventsState {
+    private static class SessionEventsState {
         private List<AppEvent> accumulatedEvents = new ArrayList<AppEvent>();
         private List<AppEvent> inFlightEvents = new ArrayList<AppEvent>();
         private int numSkippedEventsDueToFullBuffer;
@@ -1599,8 +1600,6 @@ private static void onTimeSpentDataUpdate() {
     static class PersistedEvents {
         static final String PERSISTED_EVENTS_FILENAME = "AppEventsLogger.persistedevents";
 
-        private static Object staticLock = new Object();
-
         private Context context;
         private HashMap<AccessTokenAppIdPair, List<AppEvent>> persistedEvents =
                 new HashMap<AccessTokenAppIdPair, List<AppEvent>>();
diff --git a/facebook/src/main/java/com/facebook/internal/NativeProtocol.java b/facebook/src/main/java/com/facebook/internal/NativeProtocol.java
index f6aa30434..fd0dd13eb 100644
--- a/facebook/src/main/java/com/facebook/internal/NativeProtocol.java
+++ b/facebook/src/main/java/com/facebook/internal/NativeProtocol.java
@@ -384,7 +384,8 @@ public static Intent createProxyAuthIntent(
             String e2e,
             boolean isRerequest,
             boolean isForPublish,
-            DefaultAudience defaultAudience) {
+            DefaultAudience defaultAudience,
+            String clientState) {
         for (NativeAppInfo appInfo : facebookAppInfoList) {
             Intent intent = new Intent()
                     .setClassName(appInfo.getPackage(), FACEBOOK_PROXY_AUTH_ACTIVITY)
@@ -398,6 +399,7 @@ public static Intent createProxyAuthIntent(
                 intent.putExtra(FACEBOOK_PROXY_AUTH_E2E_KEY, e2e);
             }
 
+            intent.putExtra(ServerProtocol.DIALOG_PARAM_STATE, clientState);
             intent.putExtra(
                     ServerProtocol.DIALOG_PARAM_RESPONSE_TYPE,
                     ServerProtocol.DIALOG_RESPONSE_TYPE_TOKEN_AND_SIGNED_REQUEST);
diff --git a/facebook/src/main/java/com/facebook/internal/ServerProtocol.java b/facebook/src/main/java/com/facebook/internal/ServerProtocol.java
index b8fa2622a..15ae6a657 100644
--- a/facebook/src/main/java/com/facebook/internal/ServerProtocol.java
+++ b/facebook/src/main/java/com/facebook/internal/ServerProtocol.java
@@ -56,6 +56,7 @@
     public static final String DIALOG_PARAM_SCOPE = "scope";
     public static final String DIALOG_PARAM_DEFAULT_AUDIENCE = "default_audience";
     public static final String DIALOG_PARAM_SDK_VERSION = "sdk";
+    public static final String DIALOG_PARAM_STATE = "state";
     public static final String DIALOG_REREQUEST_AUTH_TYPE = "rerequest";
     public static final String DIALOG_RESPONSE_TYPE_TOKEN_AND_SIGNED_REQUEST
             = "token,signed_request";
diff --git a/facebook/src/main/java/com/facebook/internal/Utility.java b/facebook/src/main/java/com/facebook/internal/Utility.java
index 48f2704c3..d99696b8a 100644
--- a/facebook/src/main/java/com/facebook/internal/Utility.java
+++ b/facebook/src/main/java/com/facebook/internal/Utility.java
@@ -43,6 +43,7 @@
 
 import com.facebook.AccessToken;
 import com.facebook.FacebookException;
+import com.facebook.FacebookRequestError;
 import com.facebook.FacebookSdk;
 import com.facebook.GraphRequest;
 import com.facebook.GraphResponse;
@@ -937,8 +938,11 @@ public static void deleteDirectory(File directoryOrFile) {
         }
 
         if (directoryOrFile.isDirectory()) {
-            for (File child : directoryOrFile.listFiles()) {
-                deleteDirectory(child);
+            final File[] children = directoryOrFile.listFiles();
+            if (children != null) {
+                for (final File child : children) {
+                    deleteDirectory(child);
+                }
             }
         }
         directoryOrFile.delete();
@@ -1332,7 +1336,9 @@ public boolean accept(File dir, String fileName) {
                 }
             });
 
-            numCPUCores = cpuFiles.length;
+            if (cpuFiles != null) {
+                numCPUCores = cpuFiles.length;
+            }
         } catch (Exception e) {
         }
 
@@ -1421,4 +1427,56 @@ private static void refreshTotalExternalStorage() {
     private static long convertBytesToGB(double bytes) {
         return Math.round(bytes / (1024.0 * 1024.0 * 1024.0));
     }
+
+    /**
+     * Internal helper class that is used to hold two different permission lists (granted and
+     * declined)
+     */
+    public static class PermissionsPair {
+        List<String> grantedPermissions;
+        List<String> declinedPermissions;
+
+        public PermissionsPair(List<String> grantedPermissions, List<String> declinedPermissions) {
+            this.grantedPermissions = grantedPermissions;
+            this.declinedPermissions = declinedPermissions;
+        }
+
+        public List<String> getGrantedPermissions() {
+            return grantedPermissions;
+        }
+
+        public List<String> getDeclinedPermissions() {
+            return declinedPermissions;
+        }
+    }
+
+    public static PermissionsPair handlePermissionResponse(JSONObject result)
+        throws JSONException {
+
+        JSONObject permissions = result.getJSONObject("permissions");
+
+        JSONArray data = permissions.getJSONArray("data");
+        List<String> grantedPermissions = new ArrayList<>(data.length());
+        List<String> declinedPermissions = new ArrayList<>(data.length());
+
+        for (int i = 0; i < data.length(); ++i) {
+            JSONObject object = data.optJSONObject(i);
+            String permission = object.optString("permission");
+            if (permission == null || permission.equals("installed")) {
+                continue;
+            }
+            String status = object.optString("status");
+            if (status == null) {
+                continue;
+            }
+
+            if (status.equals("granted")) {
+                grantedPermissions.add(permission);
+            } else if (status.equals("declined")) {
+                declinedPermissions.add(permission);
+            }
+        }
+
+        return new PermissionsPair(grantedPermissions, declinedPermissions);
+    }
 }
diff --git a/facebook/src/main/java/com/facebook/internal/WebDialog.java b/facebook/src/main/java/com/facebook/internal/WebDialog.java
index 9046df9a5..f92dd8230 100644
--- a/facebook/src/main/java/com/facebook/internal/WebDialog.java
+++ b/facebook/src/main/java/com/facebook/internal/WebDialog.java
@@ -227,6 +227,8 @@ protected void onCreate(Bundle savedInstanceState) {
         spinner = new ProgressDialog(getContext());
         spinner.requestWindowFeature(Window.FEATURE_NO_TITLE);
         spinner.setMessage(getContext().getString(R.string.com_facebook_loading));
+        // Stops people from accidently cancelling the login flow
+        spinner.setCanceledOnTouchOutside(false);
         spinner.setOnCancelListener(new OnCancelListener() {
             @Override
             public void onCancel(DialogInterface dialogInterface) {
diff --git a/facebook/src/main/java/com/facebook/login/DeviceAuthDialog.java b/facebook/src/main/java/com/facebook/login/DeviceAuthDialog.java
new file mode 100644
index 000000000..c190703d1
--- /dev/null
+++ b/facebook/src/main/java/com/facebook/login/DeviceAuthDialog.java
@@ -0,0 +1,435 @@
+/**
+ * Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+ *
+ * You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+ * copy, modify, and distribute this software in source code or binary form for use
+ * in connection with the web services and APIs provided by Facebook.
+ *
+ * As with any software that integrates with the Facebook platform, your use of
+ * this software is subject to the Facebook Developer Principles and Policies
+ * [http://developers.facebook.com/policy/]. This copyright notice shall be
+ * included in all copies or substantial portions of the software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+ * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+ * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+ * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+ * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+package com.facebook.login;
+
+import android.app.Dialog;
+import android.content.DialogInterface;
+import android.os.Bundle;
+import android.os.Parcel;
+import android.os.Parcelable;
+import android.support.annotation.Nullable;
+import android.support.v4.app.DialogFragment;
+import android.text.Html;
+import android.text.TextUtils;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.Button;
+import android.widget.ProgressBar;
+import android.widget.TextView;
+
+import com.facebook.AccessToken;
+import com.facebook.AccessTokenSource;
+import com.facebook.FacebookActivity;
+import com.facebook.FacebookException;
+import com.facebook.FacebookRequestError;
+import com.facebook.FacebookSdk;
+import com.facebook.GraphRequest;
+import com.facebook.GraphRequestAsyncTask;
+import com.facebook.GraphResponse;
+import com.facebook.HttpMethod;
+import com.facebook.R;
+import com.facebook.internal.Utility;
+
+import org.json.JSONException;
+import org.json.JSONObject;
+
+import java.util.Date;
+import java.util.concurrent.ScheduledFuture;
+import java.util.concurrent.TimeUnit;
+import java.util.concurrent.atomic.AtomicBoolean;
+
+public class DeviceAuthDialog extends DialogFragment {
+    private static final String DEVICE_OUATH_ENDPOINT = "oauth/device";
+    private static final String REQUEST_STATE_KEY = "request_state";
+
+    private ProgressBar progressBar;
+    private TextView confirmationCode;
+    private DeviceAuthMethodHandler deviceAuthMethodHandler;
+    private AtomicBoolean completed = new AtomicBoolean();
+    private volatile GraphRequestAsyncTask currentGraphRequestPoll;
+    private volatile ScheduledFuture scheduledPoll;
+    private volatile RequestState currentRequestState;
+    private Dialog dialog;
+
+    // Used to tell if we are destroying the fragment because it was dismissed or dismissing the
+    // fragment because it is being destroyed.
+    private boolean isBeingDestroyed = false;
+
+    @Nullable
+    @Override
+    public View onCreateView(
+            LayoutInflater inflater,
+            ViewGroup container,
+            Bundle savedInstanceState) {
+        View view = super.onCreateView(inflater, container, savedInstanceState);
+        FacebookActivity facebookActivity = (FacebookActivity) getActivity();
+        LoginFragment fragment = (LoginFragment)facebookActivity.getCurrentFragment();
+        deviceAuthMethodHandler = (DeviceAuthMethodHandler)fragment
+                .getLoginClient()
+                .getCurrentHandler();
+
+        if (savedInstanceState != null) {
+            RequestState requestState = savedInstanceState.getParcelable(REQUEST_STATE_KEY);
+            if (requestState != null) {
+                setCurrentRequestState(requestState);
+            }
+        }
+
+        return view;
+    }
+
+    @Override
+    public Dialog onCreateDialog(Bundle savedInstanceState) {
+        dialog = new Dialog(getActivity(), R.style.com_facebook_auth_dialog);
+        LayoutInflater inflater = getActivity().getLayoutInflater();
+        View view = inflater.inflate(R.layout.com_facebook_device_auth_dialog_fragment, null);
+        progressBar = (ProgressBar)view.findViewById(R.id.progress_bar);
+        confirmationCode = (TextView)view.findViewById(R.id.confirmation_code);
+
+        Button cancelButton = (Button) view.findViewById(R.id.cancel_button);
+        cancelButton.setOnClickListener(new View.OnClickListener() {
+            @Override
+            public void onClick(View v) {
+                onCancel();
+            }
+        });
+
+        TextView instructions = (TextView)view.findViewById(
+                R.id.com_facebook_device_auth_instructions);
+        instructions.setText(
+                Html.fromHtml(getString(R.string.com_facebook_device_auth_instructions)));
+
+        dialog.setContentView(view);
+        return dialog;
+    }
+
+    @Override
+    public void onDismiss(final DialogInterface dialog) {
+        super.onDismiss(dialog);
+        if (!isBeingDestroyed) {
+            onCancel();
+        }
+    }
+
+    @Override
+    public void onSaveInstanceState(Bundle outState) {
+        super.onSaveInstanceState(outState);
+        if (currentRequestState != null) {
+            outState.putParcelable(REQUEST_STATE_KEY, currentRequestState);
+        }
+    }
+
+    @Override
+    public void onDestroy() {
+        // Set this to true so we know if we are being destroyed and then dismissing the dialog
+        // Or if we are dismissing the dialog and then destroying the fragment. In latter we want
+        // to do a cancel callback.
+        isBeingDestroyed = true;
+        completed.set(true);
+        super.onDestroy();
+        if (currentGraphRequestPoll != null) {
+            currentGraphRequestPoll.cancel(true);
+        }
+
+        if (scheduledPoll != null) {
+            scheduledPoll.cancel(true);
+        }
+    }
+
+    public void startLogin(final LoginClient.Request request) {
+        Bundle parameters = new Bundle();
+        parameters.putString("type", "device_code");
+        parameters.putString("client_id", FacebookSdk.getApplicationId());
+        parameters.putString("scope", TextUtils.join(",", request.getPermissions()));
+        GraphRequest graphRequest = new GraphRequest(
+                null,
+                DEVICE_OUATH_ENDPOINT,
+                parameters,
+                HttpMethod.POST,
+                new GraphRequest.Callback() {
+            @Override
+            public void onCompleted(GraphResponse response) {
+                if (response.getError() != null) {
+                    onError(response.getError().getException());
+                    return;
+                }
+
+                JSONObject jsonObject = response.getJSONObject();
+                RequestState requestState = new RequestState();
+                try {
+                    requestState.setUserCode(jsonObject.getString("user_code"));
+                    requestState.setRequestCode(jsonObject.getString("code"));
+                    requestState.setInterval(jsonObject.getLong("interval"));
+                } catch (JSONException ex) {
+                    onError(new FacebookException(ex));
+                    return;
+                }
+
+                setCurrentRequestState(requestState);
+            }
+        });
+        graphRequest.executeAsync();
+    }
+
+    private void setCurrentRequestState(RequestState currentRequestState) {
+        this.currentRequestState = currentRequestState;
+        confirmationCode.setText(currentRequestState.getUserCode());
+        confirmationCode.setVisibility(View.VISIBLE);
+        progressBar.setVisibility(View.GONE);
+
+        // If we polled within the last interval schedule a poll else start a poll.
+        if (currentRequestState.withinLastRefreshWindow()) {
+            schedulePoll();
+        } else {
+            poll();
+        }
+    }
+
+    private void poll() {
+        currentRequestState.setLastPoll(new Date().getTime());
+        currentGraphRequestPoll = getPollRequest().executeAsync();
+    }
+
+    private void schedulePoll() {
+        scheduledPoll = DeviceAuthMethodHandler.getBackgroundExecutor().schedule(
+                new Runnable() {
+                    @Override
+                    public void run() {
+                        poll();
+                    }
+                },
+                currentRequestState.getInterval(),
+                TimeUnit.SECONDS);
+    }
+
+    private GraphRequest getPollRequest() {
+        Bundle parameters = new Bundle();
+        parameters.putString("type", "device_token");
+        parameters.putString("client_id", FacebookSdk.getApplicationId());
+        parameters.putString("code", currentRequestState.getRequestCode());
+
+        return new GraphRequest(
+                null,
+                DEVICE_OUATH_ENDPOINT,
+                parameters,
+                HttpMethod.POST,
+                new GraphRequest.Callback() {
+                    @Override
+                    public void onCompleted(GraphResponse response) {
+                        // Check if the request was already cancelled
+                        if (completed.get()) {
+                            return;
+                        }
+
+                        FacebookRequestError error = response.getError();
+                        if (error != null) {
+                            // We need to decide if this is a fatal error by checking the error
+                            // message text
+                            String errorMessage = error.getErrorMessage();
+                            if (errorMessage.equals("authorization_pending") ||
+                                    errorMessage.equals("slow_down")) {
+                                // Keep polling. If we got the slow down message just ignore
+                                schedulePoll();
+                                return;
+                            } else if (errorMessage.equals("authorization_declined") ||
+                                    errorMessage.equals("code_expired")) {
+                                onCancel();
+                                return;
+                            }
+
+                            onError(response.getError().getException());
+                            return;
+                        }
+
+                        try {
+                            JSONObject resultObject = response.getJSONObject();
+                            onSuccess(resultObject.getString("access_token"));
+                        } catch (JSONException ex) {
+                            onError(new FacebookException(ex));
+                        }
+                    }
+                });
+    }
+
+    private void onSuccess(final String accessToken) {
+        Bundle parameters = new Bundle();
+        parameters.putString("fields", "id,permissions");
+        AccessToken temporaryToken = new AccessToken(
+                accessToken,
+                FacebookSdk.getApplicationId(),
+                "0",
+                null,
+                null,
+                null,
+                null,
+                null);
+
+        GraphRequest request = new GraphRequest(
+                temporaryToken,
+                "me",
+                parameters,
+                HttpMethod.GET,
+                new GraphRequest.Callback() {
+                    @Override
+                    public void onCompleted(GraphResponse response) {
+                        if (completed.get()) {
+                            return;
+                        }
+
+                        if (response.getError() != null) {
+                            onError(response.getError().getException());
+                            return;
+                        }
+
+                        String userId;
+                        Utility.PermissionsPair permissions;
+                        try {
+                            JSONObject jsonObject = response.getJSONObject();
+                            userId = jsonObject.getString("id");
+                            permissions = Utility.handlePermissionResponse(jsonObject);
+                        } catch (JSONException ex) {
+                            onError(new FacebookException(ex));
+                            return;
+                        }
+
+                        deviceAuthMethodHandler.onSuccess(
+                                accessToken,
+                                FacebookSdk.getApplicationId(),
+                                userId,
+                                permissions.getGrantedPermissions(),
+                                permissions.getDeclinedPermissions(),
+                                AccessTokenSource.DEVICE_AUTH,
+                                null,
+                                null);
+                        dialog.dismiss();
+                    }
+                });
+        request.executeAsync();
+    }
+
+    private void onError(FacebookException ex) {
+        if (!completed.compareAndSet(false, true)) {
+            return;
+        }
+
+        deviceAuthMethodHandler.onError(ex);
+        dialog.dismiss();
+    }
+
+    private void onCancel() {
+        if (!completed.compareAndSet(false, true)) {
+            // Should not have happened but we called cancel twice
+            return;
+        }
+
+        if (deviceAuthMethodHandler != null) {
+            // We are detached and cannot send a cancel message back
+            deviceAuthMethodHandler.onCancel();
+        }
+
+        dialog.dismiss();
+    }
+
+    private static class RequestState implements Parcelable{
+        private String userCode;
+        private String requestCode;
+        private long interval;
+        private long lastPoll;
+
+        RequestState() {}
+
+        public String getUserCode() {
+            return userCode;
+        }
+
+        public void setUserCode(String userCode) {
+            this.userCode = userCode;
+        }
+
+        public String getRequestCode() {
+            return requestCode;
+        }
+
+        public void setRequestCode(String requestCode) {
+            this.requestCode = requestCode;
+        }
+
+        public long getInterval() {
+            return interval;
+        }
+
+        public void setInterval(long interval) {
+            this.interval = interval;
+        }
+
+        public void setLastPoll(long lastPoll) {
+            this.lastPoll = lastPoll;
+        }
+
+        protected RequestState(Parcel in) {
+            userCode = in.readString();
+            requestCode = in.readString();
+            interval = in.readLong();
+            lastPoll = in.readLong();
+        }
+
+        /**
+         *
+         * @return True if the current time is less than last poll time + polling interval.
+         */
+        public boolean withinLastRefreshWindow() {
+            if (lastPoll == 0) {
+                return false;
+            }
+
+            long diff = new Date().getTime() - lastPoll - interval * 1000L;
+            return diff < 0;
+        }
+
+        @Override
+        public int describeContents() {
+            return 0;
+        }
+
+        @Override
+        public void writeToParcel(Parcel dest, int flags) {
+            dest.writeString(userCode);
+            dest.writeString(requestCode);
+            dest.writeLong(interval);
+            dest.writeLong(lastPoll);
+        }
+
+        @SuppressWarnings("unused")
+        public static final Parcelable.Creator<RequestState> CREATOR =
+                new Parcelable.Creator<RequestState>() {
+            @Override
+            public RequestState createFromParcel(Parcel in) {
+                return new RequestState(in);
+            }
+
+            @Override
+            public RequestState[] newArray(int size) {
+                return new RequestState[size];
+            }
+        };
+    }
+}
diff --git a/facebook/src/main/java/com/facebook/login/DeviceAuthMethodHandler.java b/facebook/src/main/java/com/facebook/login/DeviceAuthMethodHandler.java
new file mode 100644
index 000000000..9539525f3
--- /dev/null
+++ b/facebook/src/main/java/com/facebook/login/DeviceAuthMethodHandler.java
@@ -0,0 +1,135 @@
+/**
+ * Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+ *
+ * You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+ * copy, modify, and distribute this software in source code or binary form for use
+ * in connection with the web services and APIs provided by Facebook.
+ *
+ * As with any software that integrates with the Facebook platform, your use of
+ * this software is subject to the Facebook Developer Principles and Policies
+ * [http://developers.facebook.com/policy/]. This copyright notice shall be
+ * included in all copies or substantial portions of the software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+ * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+ * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+ * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+ * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+package com.facebook.login;
+
+import android.app.Dialog;
+import android.os.Parcel;
+import android.os.Parcelable;
+
+import com.facebook.AccessToken;
+import com.facebook.AccessTokenSource;
+
+import java.util.Collection;
+import java.util.Date;
+import java.util.concurrent.ScheduledThreadPoolExecutor;
+
+class DeviceAuthMethodHandler extends LoginMethodHandler {
+    private static ScheduledThreadPoolExecutor backgroundExecutor;
+
+    DeviceAuthMethodHandler(LoginClient loginClient) {
+        super(loginClient);
+    }
+
+    @Override
+    boolean tryAuthorize(LoginClient.Request request) {
+        showDialog(request);
+        return true;
+    }
+
+    private void showDialog(final LoginClient.Request request) {
+        DeviceAuthDialog dialog = new DeviceAuthDialog();
+        dialog.show(
+                loginClient.getActivity().getSupportFragmentManager(),
+                "login_with_facebook");
+        dialog.startLogin(request);
+    }
+
+    public void onCancel() {
+        LoginClient.Result outcome = LoginClient.Result.createCancelResult(
+                loginClient.getPendingRequest(),
+                "User canceled log in.");
+        loginClient.completeAndValidate(outcome);
+    }
+
+    public void onError(Exception ex) {
+        LoginClient.Result outcome = LoginClient.Result.createErrorResult(
+                loginClient.getPendingRequest(),
+                null,
+                ex.getMessage());
+        loginClient.completeAndValidate(outcome);
+    }
+
+    public void onSuccess(
+            String accessToken,
+            String applicationId,
+            String userId,
+            Collection<String> permissions,
+            Collection<String> declinedPermissions,
+            AccessTokenSource accessTokenSource,
+            Date expirationTime,
+            Date lastRefreshTime) {
+        AccessToken token = new AccessToken(
+                accessToken,
+                applicationId,
+                userId,
+                permissions,
+                declinedPermissions,
+                accessTokenSource,
+                expirationTime,
+                lastRefreshTime);
+
+        LoginClient.Result outcome = LoginClient.Result.createTokenResult(
+                loginClient.getPendingRequest(),
+                token);
+        loginClient.completeAndValidate(outcome);
+    }
+
+    public static synchronized ScheduledThreadPoolExecutor getBackgroundExecutor() {
+        if (backgroundExecutor == null) {
+            backgroundExecutor = new ScheduledThreadPoolExecutor(1);
+        }
+
+        return backgroundExecutor;
+    }
+
+    protected DeviceAuthMethodHandler(Parcel parcel) {
+        super(parcel);
+    }
+
+    @Override
+    String getNameForLogging() {
+        return "device_auth";
+    }
+
+    @Override
+    public int describeContents() {
+        return 0;
+    }
+
+    @Override
+    public void writeToParcel(Parcel dest, int flags) {
+        super.writeToParcel(dest, flags);
+    }
+
+    public static final Parcelable.Creator<DeviceAuthMethodHandler> CREATOR =
+            new Parcelable.Creator() {
+
+                @Override
+                public DeviceAuthMethodHandler createFromParcel(Parcel source) {
+                    return new DeviceAuthMethodHandler(source);
+                }
+
+                @Override
+                public DeviceAuthMethodHandler[] newArray(int size) {
+                    return new DeviceAuthMethodHandler[size];
+                }
+            };
+}
diff --git a/facebook/src/main/java/com/facebook/login/KatanaProxyLoginMethodHandler.java b/facebook/src/main/java/com/facebook/login/KatanaProxyLoginMethodHandler.java
index 2385e9f40..9fb8c5b7d 100644
--- a/facebook/src/main/java/com/facebook/login/KatanaProxyLoginMethodHandler.java
+++ b/facebook/src/main/java/com/facebook/login/KatanaProxyLoginMethodHandler.java
@@ -56,7 +56,8 @@ boolean tryAuthorize(LoginClient.Request request) {
                 e2e,
                 request.isRerequest(),
                 request.hasPublishPermission(),
-                request.getDefaultAudience());
+                request.getDefaultAudience(),
+                getClientState(request.getAuthId()));
 
         addLoggingExtra(ServerProtocol.DIALOG_PARAM_E2E, e2e);
 
diff --git a/facebook/src/main/java/com/facebook/login/LoginBehavior.java b/facebook/src/main/java/com/facebook/login/LoginBehavior.java
index aa42c4ec0..57b7d589f 100644
--- a/facebook/src/main/java/com/facebook/login/LoginBehavior.java
+++ b/facebook/src/main/java/com/facebook/login/LoginBehavior.java
@@ -28,25 +28,32 @@
      * Specifies that login should attempt login in using the Facebook App, and if that
      * does not work fall back to web dialog auth. This is the default behavior.
      */
-    NATIVE_WITH_FALLBACK(true, true),
+    NATIVE_WITH_FALLBACK(true, true, false),
 
     /**
      * Specifies that login should only attempt to login using the Facebook App.
      * If the Facebook App cannot be used then the login fails.
      */
-    NATIVE_ONLY(true, false),
+    NATIVE_ONLY(true, false, false),
 
     /**
      * Specifies that only the web dialog auth should be used.
      */
-    WEB_ONLY(false, true);
+    WEB_ONLY(false, true, false),
+
+    DEVICE_AUTH(false, false, true);
 
     private final boolean allowsKatanaAuth;
     private final boolean allowsWebViewAuth;
+    private final boolean allowsDeviceAuth;
 
-    private LoginBehavior(boolean allowsKatanaAuth, boolean allowsWebViewAuth) {
+    private LoginBehavior(
+            boolean allowsKatanaAuth,
+            boolean allowsWebViewAuth,
+            boolean allowsDeviceAuth) {
         this.allowsKatanaAuth = allowsKatanaAuth;
         this.allowsWebViewAuth = allowsWebViewAuth;
+        this.allowsDeviceAuth = allowsDeviceAuth;
     }
 
     boolean allowsKatanaAuth() {
@@ -56,4 +63,8 @@ boolean allowsKatanaAuth() {
     boolean allowsWebViewAuth() {
         return allowsWebViewAuth;
     }
+
+    boolean allowsDeviceAuth() {
+        return allowsDeviceAuth;
+    }
 }
diff --git a/facebook/src/main/java/com/facebook/login/LoginClient.java b/facebook/src/main/java/com/facebook/login/LoginClient.java
index a4ced69f6..779460ddb 100644
--- a/facebook/src/main/java/com/facebook/login/LoginClient.java
+++ b/facebook/src/main/java/com/facebook/login/LoginClient.java
@@ -55,7 +55,7 @@
 import java.util.Set;
 
 class LoginClient implements Parcelable {
-    LoginMethodHandler [] handlersToTry;
+    LoginMethodHandler[] handlersToTry;
     int currentHandler = -1;
     Fragment fragment;
     OnCompletedListener onCompletedListener;
@@ -137,7 +137,7 @@ void cancelCurrentHandler() {
         }
     }
 
-    private LoginMethodHandler getCurrentHandler() {
+    LoginMethodHandler getCurrentHandler() {
         if (currentHandler >= 0) {
             return handlersToTry[currentHandler];
         } else {
@@ -167,6 +167,10 @@ public boolean onActivityResult(int requestCode, int resultCode, Intent data) {
             handlers.add(new WebViewLoginMethodHandler(this));
         }
 
+        if (behavior.allowsDeviceAuth()) {
+            handlers.add(new DeviceAuthMethodHandler(this));
+        }
+
         LoginMethodHandler [] result = new LoginMethodHandler[handlers.size()];
         handlers.toArray(result);
         return result;
@@ -631,72 +635,6 @@ public Result createFromParcel(Parcel source) {
         };
     }
 
-    /**
-     * Internal helper class that is used to hold two different permission lists (granted and
-     * declined)
-     */
-    private static class PermissionsPair {
-        List<String> grantedPermissions;
-        List<String> declinedPermissions;
-
-        public PermissionsPair(List<String> grantedPermissions, List<String> declinedPermissions) {
-            this.grantedPermissions = grantedPermissions;
-            this.declinedPermissions = declinedPermissions;
-        }
-
-        public List<String> getGrantedPermissions() {
-            return grantedPermissions;
-        }
-
-        public List<String> getDeclinedPermissions() {
-            return declinedPermissions;
-        }
-    }
-
-    /**
-     * This parses a server response to a call to me/permissions.  It will return the list of
-     * granted permissions. It will optionally update an access token with the requested permissions.
-     *
-     * @param response The server response
-     * @return A list of granted permissions or null if an error
-     */
-    private static PermissionsPair handlePermissionResponse(GraphResponse response) {
-        if (response.getError() != null) {
-            return null;
-        }
-
-        JSONObject result = response.getJSONObject();
-        if (result == null) {
-            return null;
-        }
-
-        JSONArray data = result.optJSONArray("data");
-        if (data == null || data.length() == 0) {
-            return null;
-        }
-        List<String> grantedPermissions = new ArrayList<String>(data.length());
-        List<String> declinedPermissions = new ArrayList<String>(data.length());
-
-        for (int i = 0; i < data.length(); ++i) {
-            JSONObject object = data.optJSONObject(i);
-            String permission = object.optString("permission");
-            if (permission == null || permission.equals("installed")) {
-                continue;
-            }
-            String status = object.optString("status");
-            if (status == null) {
-                continue;
-            }
-            if(status.equals("granted")) {
-                grantedPermissions.add(permission);
-            } else if (status.equals("declined")) {
-                declinedPermissions.add(permission);
-            }
-        }
-
-        return new PermissionsPair(grantedPermissions, declinedPermissions);
-    }
-
     // Parcelable implementation
 
     public LoginClient(Parcel source) {
diff --git a/facebook/src/main/java/com/facebook/login/LoginFragment.java b/facebook/src/main/java/com/facebook/login/LoginFragment.java
index 3131f91bf..4a40f85ed 100644
--- a/facebook/src/main/java/com/facebook/login/LoginFragment.java
+++ b/facebook/src/main/java/com/facebook/login/LoginFragment.java
@@ -79,8 +79,12 @@ public void onCompleted(LoginClient.Result outcome) {
 
         initializeCallingPackage(activity);
         if (activity.getIntent() != null) {
-            request = (LoginClient.Request)
-                    activity.getIntent().getParcelableExtra(EXTRA_REQUEST);
+            Intent intent = activity.getIntent();
+            // Set the class loader explicitly to avoid a possible issue where the wrong
+            // class loader is used by android for unmarshalling LoginClient.Request on
+            // Samsung devices
+            intent.setExtrasClassLoader(LoginClient.Request.class.getClassLoader());
+            request = (LoginClient.Request)intent.getParcelableExtra(EXTRA_REQUEST);
         }
     }
 
@@ -176,4 +180,8 @@ private void initializeCallingPackage(final Activity activity) {
         }
         callingPackage = componentName.getPackageName();
     }
+
+    LoginClient getLoginClient() {
+        return loginClient;
+    }
 }
diff --git a/facebook/src/main/java/com/facebook/login/LoginMethodHandler.java b/facebook/src/main/java/com/facebook/login/LoginMethodHandler.java
index 4412561b9..95ad49009 100644
--- a/facebook/src/main/java/com/facebook/login/LoginMethodHandler.java
+++ b/facebook/src/main/java/com/facebook/login/LoginMethodHandler.java
@@ -25,6 +25,7 @@
 import android.os.Parcel;
 import android.os.Parcelable;
 import android.util.Base64;
+import android.util.Log;
 
 import com.facebook.AccessToken;
 import com.facebook.AccessTokenSource;
@@ -83,6 +84,17 @@ boolean needsInternetPermission() {
     void cancel() {
     }
 
+    protected String getClientState(String authId) {
+        JSONObject param = new JSONObject();
+        try {
+            param.put(LoginLogger.EVENT_PARAM_AUTH_LOGGER_ID, authId);
+            param.put(LoginLogger.EVENT_PARAM_METHOD, getNameForLogging());
+        } catch (JSONException e) {
+            Log.w("LoginMethodHandler", "Error creating client state json: " + e.getMessage());
+        }
+        return param.toString();
+    }
+
     protected void addLoggingExtra(String key, Object value) {
         if (methodLoggingExtras == null) {
             methodLoggingExtras = new HashMap<String, String>();
diff --git a/facebook/src/main/java/com/facebook/login/WebViewLoginMethodHandler.java b/facebook/src/main/java/com/facebook/login/WebViewLoginMethodHandler.java
index 635860db9..772fbf7ed 100644
--- a/facebook/src/main/java/com/facebook/login/WebViewLoginMethodHandler.java
+++ b/facebook/src/main/java/com/facebook/login/WebViewLoginMethodHandler.java
@@ -116,6 +116,8 @@ public void onComplete(Bundle values, FacebookException error) {
 
         e2e = LoginClient.getE2E();
         addLoggingExtra(ServerProtocol.DIALOG_PARAM_E2E, e2e);
+        parameters.putString(
+                ServerProtocol.DIALOG_PARAM_STATE, getClientState(request.getAuthId()));
 
         FragmentActivity fragmentActivity = loginClient.getActivity();
         WebDialog.Builder builder = new AuthDialogBuilder(
diff --git a/facebook/src/main/java/com/facebook/share/ShareApi.java b/facebook/src/main/java/com/facebook/share/ShareApi.java
index 695c328e8..2917e345e 100644
--- a/facebook/src/main/java/com/facebook/share/ShareApi.java
+++ b/facebook/src/main/java/com/facebook/share/ShareApi.java
@@ -350,6 +350,13 @@ public void onCompleted(GraphResponse response) {
         };
         try {
             for (SharePhoto photo : photoContent.getPhotos()) {
+                Bundle params = null;
+                try {
+                    params = getSharePhotoCommonParameters(photo, photoContent);
+                } catch (JSONException e) {
+                    ShareInternalUtility.invokeCallbackWithException(callback, e);
+                    return;
+                }
                 final Bitmap bitmap = photo.getBitmap();
                 final Uri photoUri = photo.getImageUrl();
                 String caption = photo.getCaption();
@@ -362,7 +369,7 @@ public void onCompleted(GraphResponse response) {
                             getGraphPath(PHOTOS_EDGE),
                             bitmap,
                             caption,
-                            photo.getParameters(),
+                            params,
                             requestCallback));
                 } else if (photoUri != null) {
                     requests.add(GraphRequest.newUploadPhotoRequest(
@@ -370,7 +377,7 @@ public void onCompleted(GraphResponse response) {
                             getGraphPath(PHOTOS_EDGE),
                             photoUri,
                             caption,
-                            photo.getParameters(),
+                            params,
                             requestCallback));
                 }
             }
@@ -418,6 +425,33 @@ private void shareVideoContent(final ShareVideoContent videoContent,
         }
     }
 
+    private Bundle getSharePhotoCommonParameters(SharePhoto photo, SharePhotoContent photoContent)
+            throws JSONException{
+        Bundle params = photo.getParameters();
+        if (!params.containsKey("place")
+                && !Utility.isNullOrEmpty(photoContent.getPlaceId())) {
+            params.putString("place", photoContent.getPlaceId());
+        }
+        if (!params.containsKey("tags")
+                && !Utility.isNullOrEmpty(photoContent.getPeopleIds())) {
+            final List<String> peopleIds = photoContent.getPeopleIds();
+            if (!Utility.isNullOrEmpty(peopleIds)) {
+                JSONArray tags = new JSONArray();
+                for (String id : peopleIds) {
+                    JSONObject tag = new JSONObject();
+                    tag.put("tag_uid", id);
+                    tags.put(tag);
+                }
+                params.putString("tags", tags.toString());
+            }
+        }
+        if (!params.containsKey("ref")
+                && !Utility.isNullOrEmpty(photoContent.getRef())) {
+            params.putString("ref", photoContent.getRef());
+        }
+        return params;
+    }
+
     private void stageArrayList(final ArrayList arrayList,
                                        final CollectionMapper.OnMapValueCompleteListener
                                                onArrayListStagedListener) {
diff --git a/facebook/src/main/java/com/facebook/share/internal/LikeActionController.java b/facebook/src/main/java/com/facebook/share/internal/LikeActionController.java
index 9c5e741fd..04caec8ef 100644
--- a/facebook/src/main/java/com/facebook/share/internal/LikeActionController.java
+++ b/facebook/src/main/java/com/facebook/share/internal/LikeActionController.java
@@ -1577,8 +1577,6 @@ public String getUnlikeToken() {
         }
     }
 
-
-
     private class GetEngagementRequestWrapper extends AbstractRequestWrapper {
         // Initialize the like status to what we currently have. This way, empty/error responses
         // don't end up clearing out the state.
@@ -1600,6 +1598,9 @@ public String getUnlikeToken() {
                             "social_sentence_with_like," +
                             "social_sentence_without_like)");
 
+            // Ensure that the social sentence returned is localized
+            requestParams.putString("locale", Locale.getDefault().toString());
+
             setRequest(new GraphRequest(
                     AccessToken.getCurrentAccessToken(),
                     objectId,
diff --git a/facebook/src/main/java/com/facebook/share/internal/ShareContentValidation.java b/facebook/src/main/java/com/facebook/share/internal/ShareContentValidation.java
index c3b0aebb1..4a03d46fd 100644
--- a/facebook/src/main/java/com/facebook/share/internal/ShareContentValidation.java
+++ b/facebook/src/main/java/com/facebook/share/internal/ShareContentValidation.java
@@ -315,6 +315,21 @@ public void validate(final SharePhoto photo) {
             validatePhotoForApi(photo, this);
         }
 
+        @Override
+        public void validate(ShareVideoContent videoContent) {
+            if (!Utility.isNullOrEmpty(videoContent.getPlaceId())) {
+                throw new FacebookException(
+                        "Cannot share video content with place IDs using the share api");
+            }
+            if (!Utility.isNullOrEmpty(videoContent.getPeopleIds())) {
+                throw new FacebookException(
+                        "Cannot share video content with people IDs using the share api");
+            }
+            if (!Utility.isNullOrEmpty(videoContent.getRef())) {
+                throw new FacebookException(
+                        "Cannot share video content with referrer URL using the share api");
+            }
+        }
     }
 
     private static class Validator {
diff --git a/facebook/src/main/java/com/facebook/share/internal/VideoUploader.java b/facebook/src/main/java/com/facebook/share/internal/VideoUploader.java
index fc7c0bae7..52a012d9d 100644
--- a/facebook/src/main/java/com/facebook/share/internal/VideoUploader.java
+++ b/facebook/src/main/java/com/facebook/share/internal/VideoUploader.java
@@ -25,6 +25,7 @@
 import android.os.Handler;
 import android.os.Looper;
 import android.os.ParcelFileDescriptor;
+import android.text.TextUtils;
 import android.util.Log;
 
 import com.facebook.AccessToken;
@@ -317,6 +318,17 @@ private UploadContext(
             this.graphNode = graphNode;
             this.callback = callback;
             this.params = videoContent.getVideo().getParameters();
+            if (!Utility.isNullOrEmpty(videoContent.getPeopleIds())) {
+                this.params.putString("tags", TextUtils.join(", ", videoContent.getPeopleIds()));
+            }
+
+            if (!Utility.isNullOrEmpty(videoContent.getPlaceId())) {
+                this.params.putString("place", videoContent.getPlaceId());
+            }
+
+            if (!Utility.isNullOrEmpty(videoContent.getRef())) {
+                this.params.putString("ref", videoContent.getRef());
+            }
         }
 
         private void initialize()
diff --git a/facebook/src/main/res/color/com_facebook_button_text_color.xml b/facebook/src/main/res/color/com_facebook_button_text_color.xml
new file mode 100644
index 000000000..028198809
--- /dev/null
+++ b/facebook/src/main/res/color/com_facebook_button_text_color.xml
@@ -0,0 +1,24 @@
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_enabled="true" android:color="@color/com_facebook_blue" />
+    <item android:color="#fffffe" />
+</selector>
diff --git a/facebook/src/main/res/color/com_facebook_send_button_text_color.xml b/facebook/src/main/res/color/com_facebook_send_button_text_color.xml
new file mode 100644
index 000000000..d02ee0208
--- /dev/null
+++ b/facebook/src/main/res/color/com_facebook_send_button_text_color.xml
@@ -0,0 +1,24 @@
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_enabled="true" android:color="@color/com_facebook_messenger_blue" />
+    <item android:color="#fffffe" />
+</selector>
diff --git a/facebook/src/main/res/drawable-hdpi/com_facebook_button_icon_blue.png b/facebook/src/main/res/drawable-hdpi/com_facebook_button_icon_blue.png
new file mode 100644
index 000000000..dd8e61a62
Binary files /dev/null and b/facebook/src/main/res/drawable-hdpi/com_facebook_button_icon_blue.png differ
diff --git a/facebook/src/main/res/drawable-hdpi/com_facebook_button_icon.png b/facebook/src/main/res/drawable-hdpi/com_facebook_button_icon_white.png
similarity index 100%
rename from facebook/src/main/res/drawable-hdpi/com_facebook_button_icon.png
rename to facebook/src/main/res/drawable-hdpi/com_facebook_button_icon_white.png
diff --git a/facebook/src/main/res/drawable-hdpi/com_facebook_button_send_icon_blue.png b/facebook/src/main/res/drawable-hdpi/com_facebook_button_send_icon_blue.png
new file mode 100644
index 000000000..361e63874
Binary files /dev/null and b/facebook/src/main/res/drawable-hdpi/com_facebook_button_send_icon_blue.png differ
diff --git a/facebook/src/main/res/drawable-hdpi/com_facebook_button_send_icon.png b/facebook/src/main/res/drawable-hdpi/com_facebook_button_send_icon_white.png
similarity index 100%
rename from facebook/src/main/res/drawable-hdpi/com_facebook_button_send_icon.png
rename to facebook/src/main/res/drawable-hdpi/com_facebook_button_send_icon_white.png
diff --git a/facebook/src/main/res/drawable-hdpi/com_facebook_favicon_white.png b/facebook/src/main/res/drawable-hdpi/com_facebook_favicon_white.png
new file mode 100644
index 000000000..3042a7bb2
Binary files /dev/null and b/facebook/src/main/res/drawable-hdpi/com_facebook_favicon_white.png differ
diff --git a/facebook/src/main/res/drawable-mdpi/com_facebook_button_icon_blue.png b/facebook/src/main/res/drawable-mdpi/com_facebook_button_icon_blue.png
new file mode 100644
index 000000000..fa21c2e81
Binary files /dev/null and b/facebook/src/main/res/drawable-mdpi/com_facebook_button_icon_blue.png differ
diff --git a/facebook/src/main/res/drawable-mdpi/com_facebook_button_icon.png b/facebook/src/main/res/drawable-mdpi/com_facebook_button_icon_white.png
similarity index 100%
rename from facebook/src/main/res/drawable-mdpi/com_facebook_button_icon.png
rename to facebook/src/main/res/drawable-mdpi/com_facebook_button_icon_white.png
diff --git a/facebook/src/main/res/drawable-mdpi/com_facebook_button_send_icon_blue.png b/facebook/src/main/res/drawable-mdpi/com_facebook_button_send_icon_blue.png
new file mode 100644
index 000000000..5d58986ab
Binary files /dev/null and b/facebook/src/main/res/drawable-mdpi/com_facebook_button_send_icon_blue.png differ
diff --git a/facebook/src/main/res/drawable-mdpi/com_facebook_button_send_icon.png b/facebook/src/main/res/drawable-mdpi/com_facebook_button_send_icon_white.png
similarity index 100%
rename from facebook/src/main/res/drawable-mdpi/com_facebook_button_send_icon.png
rename to facebook/src/main/res/drawable-mdpi/com_facebook_button_send_icon_white.png
diff --git a/facebook/src/main/res/drawable-mdpi/com_facebook_favicon_white.png b/facebook/src/main/res/drawable-mdpi/com_facebook_favicon_white.png
new file mode 100644
index 000000000..72fe4b60b
Binary files /dev/null and b/facebook/src/main/res/drawable-mdpi/com_facebook_favicon_white.png differ
diff --git a/facebook/src/main/res/drawable-xhdpi/com_facebook_button_icon_blue.png b/facebook/src/main/res/drawable-xhdpi/com_facebook_button_icon_blue.png
new file mode 100644
index 000000000..f4141461b
Binary files /dev/null and b/facebook/src/main/res/drawable-xhdpi/com_facebook_button_icon_blue.png differ
diff --git a/facebook/src/main/res/drawable-xhdpi/com_facebook_button_icon.png b/facebook/src/main/res/drawable-xhdpi/com_facebook_button_icon_white.png
similarity index 100%
rename from facebook/src/main/res/drawable-xhdpi/com_facebook_button_icon.png
rename to facebook/src/main/res/drawable-xhdpi/com_facebook_button_icon_white.png
diff --git a/facebook/src/main/res/drawable-xhdpi/com_facebook_button_send_icon_blue.png b/facebook/src/main/res/drawable-xhdpi/com_facebook_button_send_icon_blue.png
new file mode 100644
index 000000000..1fc78ad78
Binary files /dev/null and b/facebook/src/main/res/drawable-xhdpi/com_facebook_button_send_icon_blue.png differ
diff --git a/facebook/src/main/res/drawable-xhdpi/com_facebook_button_send_icon.png b/facebook/src/main/res/drawable-xhdpi/com_facebook_button_send_icon_white.png
similarity index 100%
rename from facebook/src/main/res/drawable-xhdpi/com_facebook_button_send_icon.png
rename to facebook/src/main/res/drawable-xhdpi/com_facebook_button_send_icon_white.png
diff --git a/facebook/src/main/res/drawable-xhdpi/com_facebook_favicon_white.png b/facebook/src/main/res/drawable-xhdpi/com_facebook_favicon_white.png
new file mode 100644
index 000000000..ce5c8909f
Binary files /dev/null and b/facebook/src/main/res/drawable-xhdpi/com_facebook_favicon_white.png differ
diff --git a/facebook/src/main/res/drawable-xxhdpi/com_facebook_button_icon_blue.png b/facebook/src/main/res/drawable-xxhdpi/com_facebook_button_icon_blue.png
new file mode 100644
index 000000000..01480c9f5
Binary files /dev/null and b/facebook/src/main/res/drawable-xxhdpi/com_facebook_button_icon_blue.png differ
diff --git a/facebook/src/main/res/drawable-xxhdpi/com_facebook_button_icon.png b/facebook/src/main/res/drawable-xxhdpi/com_facebook_button_icon_white.png
similarity index 100%
rename from facebook/src/main/res/drawable-xxhdpi/com_facebook_button_icon.png
rename to facebook/src/main/res/drawable-xxhdpi/com_facebook_button_icon_white.png
diff --git a/facebook/src/main/res/drawable-xxhdpi/com_facebook_button_send_icon.png b/facebook/src/main/res/drawable-xxhdpi/com_facebook_button_send_icon_white.png
similarity index 100%
rename from facebook/src/main/res/drawable-xxhdpi/com_facebook_button_send_icon.png
rename to facebook/src/main/res/drawable-xxhdpi/com_facebook_button_send_icon_white.png
diff --git a/facebook/src/main/res/drawable-xxhdpi/com_facebook_favicon_white.png b/facebook/src/main/res/drawable-xxhdpi/com_facebook_favicon_white.png
new file mode 100644
index 000000000..82fd70fae
Binary files /dev/null and b/facebook/src/main/res/drawable-xxhdpi/com_facebook_favicon_white.png differ
diff --git a/facebook/src/main/res/drawable/com_facebook_auth_dialog_background.xml b/facebook/src/main/res/drawable/com_facebook_auth_dialog_background.xml
new file mode 100644
index 000000000..2088e1b1c
--- /dev/null
+++ b/facebook/src/main/res/drawable/com_facebook_auth_dialog_background.xml
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<shape xmlns:android="http://schemas.android.com/apk/res/android">
+    <solid android:color="#f2fafafa" />
+    <corners
+        android:bottomLeftRadius="@dimen/com_facebook_auth_dialog_corner_radius"
+        android:bottomRightRadius="@dimen/com_facebook_auth_dialog_corner_radius"
+        android:topLeftRadius="@dimen/com_facebook_auth_dialog_corner_radius_oversized"
+        android:topRightRadius="@dimen/com_facebook_auth_dialog_corner_radius_oversized" />
+</shape>
diff --git a/facebook/src/main/res/drawable/com_facebook_auth_dialog_cancel_background.xml b/facebook/src/main/res/drawable/com_facebook_auth_dialog_cancel_background.xml
new file mode 100644
index 000000000..17f07a862
--- /dev/null
+++ b/facebook/src/main/res/drawable/com_facebook_auth_dialog_cancel_background.xml
@@ -0,0 +1,35 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_pressed="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="2dp" />
+            <solid android:color="#999999" />
+        </shape>
+    </item>
+    <item>
+        <shape android:shape="rectangle">
+            <corners android:radius="2dp" />
+            <solid android:color="#33999999" />
+        </shape>
+    </item>
+</selector>
diff --git a/facebook/src/main/res/drawable/com_facebook_auth_dialog_header_background.xml b/facebook/src/main/res/drawable/com_facebook_auth_dialog_header_background.xml
new file mode 100644
index 000000000..3321bf82c
--- /dev/null
+++ b/facebook/src/main/res/drawable/com_facebook_auth_dialog_header_background.xml
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<shape xmlns:android="http://schemas.android.com/apk/res/android">
+    <solid android:color="@color/com_facebook_blue" />
+    <corners
+        android:bottomLeftRadius="0dp"
+        android:bottomRightRadius="0dp"
+        android:topLeftRadius="@dimen/com_facebook_auth_dialog_corner_radius"
+        android:topRightRadius="@dimen/com_facebook_auth_dialog_corner_radius" />
+</shape>
diff --git a/facebook/src/main/res/drawable/com_facebook_button_background.xml b/facebook/src/main/res/drawable/com_facebook_button_background.xml
index cd814039c..c3c794102 100644
--- a/facebook/src/main/res/drawable/com_facebook_button_background.xml
+++ b/facebook/src/main/res/drawable/com_facebook_button_background.xml
@@ -20,21 +20,39 @@
 -->
 
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
-    <item android:state_enabled="false">
+    <item android:state_enabled="false"
+        android:state_focused="true">
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
+            <solid android:color="@color/com_facebook_button_background_color_focused_disabled" />
+        </shape>
+    </item>
+    <item android:state_enabled="false"
+        android:state_focused="false">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_background_color_disabled" />
         </shape>
     </item>
+    <item android:state_focused="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
+            <solid android:color="@color/com_facebook_button_background_color_focused" />
+            <stroke
+                android:width="1dp"
+                android:color="@color/com_facebook_button_border_color_focused" >
+            </stroke>
+        </shape>
+    </item>
     <item android:state_pressed="true">
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_background_color_pressed" />
         </shape>
     </item>
     <item>
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_background_color" />
         </shape>
     </item>
diff --git a/facebook/src/main/res/drawable/com_facebook_button_icon.xml b/facebook/src/main/res/drawable/com_facebook_button_icon.xml
new file mode 100644
index 000000000..8012a8cf0
--- /dev/null
+++ b/facebook/src/main/res/drawable/com_facebook_button_icon.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_enabled="true" android:drawable="@drawable/com_facebook_button_icon_blue"/>
+    <item android:drawable="@drawable/com_facebook_button_icon_white"/>
+</selector>
diff --git a/facebook/src/main/res/drawable/com_facebook_button_like_background.xml b/facebook/src/main/res/drawable/com_facebook_button_like_background.xml
index 0aa75000f..ecbb4c1b1 100644
--- a/facebook/src/main/res/drawable/com_facebook_button_like_background.xml
+++ b/facebook/src/main/res/drawable/com_facebook_button_like_background.xml
@@ -20,27 +20,41 @@
 -->
 
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
-    <item android:state_enabled="false">
+    <item android:state_pressed="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
+            <solid android:color="@color/com_facebook_button_background_color_pressed" />
+        </shape>
+    </item>
+    <item android:state_enabled="false"
+        android:state_focused="true">
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
+            <solid android:color="@color/com_facebook_button_background_color_focused_disabled" />
+        </shape>
+    </item>
+    <item android:state_enabled="false"
+        android:state_focused="false">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_background_color_disabled" />
         </shape>
     </item>
-    <item android:state_pressed="true">
+    <item android:state_focused="true">
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
-            <solid android:color="@color/com_facebook_button_background_color_pressed" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
+            <solid android:color="@color/com_facebook_button_background_color_focused" />
         </shape>
     </item>
     <item android:state_selected="true">
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
-            <solid android:color="@color/com_facebook_button_like_background_color_selected" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
+            <solid android:color="@color/com_facebook_button_background_color_selected" />
         </shape>
     </item>
     <item>
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_background_color" />
         </shape>
     </item>
diff --git a/facebook/src/main/res/drawable/com_facebook_button_login_silver_background.xml b/facebook/src/main/res/drawable/com_facebook_button_login_silver_background.xml
index b9cff4a61..87ae0992c 100644
--- a/facebook/src/main/res/drawable/com_facebook_button_login_silver_background.xml
+++ b/facebook/src/main/res/drawable/com_facebook_button_login_silver_background.xml
@@ -22,19 +22,19 @@
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
     <item android:state_enabled="false">
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_background_color_disabled" />
         </shape>
     </item>
     <item android:state_pressed="true">
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_login_silver_background_color_pressed" />
         </shape>
     </item>
     <item>
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_login_silver_background_color" />
         </shape>
     </item>
diff --git a/facebook/src/main/res/drawable/com_facebook_button_send_background.xml b/facebook/src/main/res/drawable/com_facebook_button_send_background.xml
index 26d12d09e..9b685a7d3 100644
--- a/facebook/src/main/res/drawable/com_facebook_button_send_background.xml
+++ b/facebook/src/main/res/drawable/com_facebook_button_send_background.xml
@@ -20,12 +20,30 @@
 -->
 
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
-    <item android:state_enabled="false">
+    <item android:state_enabled="false"
+        android:state_focused="true">
         <shape android:shape="rectangle">
-            <corners android:radius="2dp" />
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
+            <solid android:color="@color/com_facebook_button_background_color_focused_disabled" />
+        </shape>
+    </item>
+    <item android:state_enabled="false"
+        android:state_focused="false">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
             <solid android:color="@color/com_facebook_button_background_color_disabled" />
         </shape>
     </item>
+    <item android:state_focused="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/com_facebook_button_corner_radius" />
+            <solid android:color="@color/com_facebook_button_background_color_focused" />
+            <stroke
+                android:width="1dp"
+                android:color="@color/com_facebook_button_border_color_focused" >
+            </stroke>
+        </shape>
+    </item>
     <item android:state_pressed="true">
         <shape android:shape="rectangle">
             <corners android:radius="2dp" />
diff --git a/facebook/src/main/res/drawable/com_facebook_send_button_icon.xml b/facebook/src/main/res/drawable/com_facebook_send_button_icon.xml
new file mode 100644
index 000000000..576272d8e
--- /dev/null
+++ b/facebook/src/main/res/drawable/com_facebook_send_button_icon.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_enabled="true" android:drawable="@drawable/com_facebook_button_send_icon_blue"/>
+    <item android:drawable="@drawable/com_facebook_button_send_icon_white"/>
+</selector>
diff --git a/facebook/src/main/res/layout/com_facebook_device_auth_dialog_fragment.xml b/facebook/src/main/res/layout/com_facebook_device_auth_dialog_fragment.xml
new file mode 100644
index 000000000..6595897e1
--- /dev/null
+++ b/facebook/src/main/res/layout/com_facebook_device_auth_dialog_fragment.xml
@@ -0,0 +1,135 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<android.support.v7.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:card_view="http://schemas.android.com/apk/res-auto"
+    android:layout_width="wrap_content"
+    android:layout_height="wrap_content"
+    card_view:cardBackgroundColor="@android:color/transparent"
+    card_view:cardElevation="10dp">
+
+    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:background="@drawable/com_facebook_auth_dialog_background"
+        android:orientation="vertical">
+
+        <RelativeLayout
+            android:layout_width="300dp"
+            android:layout_height="wrap_content"
+            android:background="@drawable/com_facebook_auth_dialog_header_background"
+            android:orientation="horizontal">
+
+            <FrameLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content">
+
+                <ImageView
+                    android:layout_width="18dp"
+                    android:layout_height="18dp"
+                    android:layout_marginBottom="11dp"
+                    android:layout_marginLeft="12dp"
+                    android:layout_marginTop="11dp"
+                    android:adjustViewBounds="false"
+                    android:scaleType="fitXY"
+                    android:src="@drawable/com_facebook_favicon_white" />
+            </FrameLayout>
+
+            <TextView
+                android:id="@+id/textView"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_centerInParent="true"
+                android:fontFamily="sans-serif-light"
+                android:gravity="center"
+                android:text="@string/com_facebook_loginview_log_in_button_long"
+                android:textColor="@color/com_facebook_share_button_text_color"
+                android:textSize="13sp"
+                android:typeface="sans" />
+
+        </RelativeLayout>
+
+        <TextView
+            android:id="@+id/com_facebook_device_auth_instructions"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="28dp"
+            android:fontFamily="sans-serif-light"
+            android:gravity="center_horizontal"
+            android:singleLine="false"
+            android:textColor="@color/com_facebook_device_auth_text"
+            android:textSize="14sp"
+            android:typeface="sans" />
+
+        <RelativeLayout
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_gravity="center_horizontal"
+            android:layout_marginTop="14dp">
+
+            <TextView
+                android:id="@+id/confirmation_code"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_gravity="center_horizontal"
+                android:fontFamily="sans-serif-light"
+                android:textColor="@color/com_facebook_device_auth_text"
+                android:textSize="23sp"
+                android:typeface="sans"
+                android:visibility="invisible" />
+
+            <ProgressBar
+                android:id="@+id/progress_bar"
+                style="@android:style/Widget.Holo.Light.ProgressBar"
+                android:layout_width="wrap_content"
+                android:layout_height="0dp"
+                android:layout_alignBottom="@+id/confirmation_code"
+                android:layout_alignTop="@+id/confirmation_code"
+                android:layout_centerHorizontal="true"
+                android:layout_centerInParent="true"
+                android:layout_centerVertical="true" />
+        </RelativeLayout>
+
+        <FrameLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:layout_marginBottom="14dp"
+            android:layout_marginTop="17dp">
+
+            <Button
+                android:id="@+id/cancel_button"
+                android:layout_width="84dp"
+                android:layout_height="27dp"
+                android:layout_gravity="center_horizontal"
+                android:background="@drawable/com_facebook_auth_dialog_cancel_background"
+                android:clickable="true"
+                android:focusable="true"
+                android:fontFamily="sans-serif-medium"
+                android:text="@android:string/cancel"
+                android:textAllCaps="true"
+                android:textColor="@color/com_facebook_device_auth_text"
+                android:textSize="10sp"
+                android:textStyle="bold"
+                android:typeface="sans" />
+        </FrameLayout>
+
+    </LinearLayout>
+</android.support.v7.widget.CardView>
diff --git a/facebook/src/main/res/values-af/strings.xml b/facebook/src/main/res/values-af/strings.xml
index 3400cae2c..0043107da 100644
--- a/facebook/src/main/res/values-af/strings.xml
+++ b/facebook/src/main/res/values-af/strings.xml
@@ -37,4 +37,5 @@
         prent.</string>
     <string name="com_facebook_share_button_text">Deel</string>
     <string name="com_facebook_send_button_text">Stuur</string>
+    <string name="com_facebook_device_auth_instructions">Besoek %@ op jou slimfoon of rekenaar en voer hierdie kode in:</string>
 </resources>
diff --git a/facebook/src/main/res/values-ar/strings.xml b/facebook/src/main/res/values-ar/strings.xml
index 4380e9073..d21abed0d 100644
--- a/facebook/src/main/res/values-ar/strings.xml
+++ b/facebook/src/main/res/values-ar/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">      .</string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions"> %@         :</string>
 </resources>
diff --git a/facebook/src/main/res/values-bn/strings.xml b/facebook/src/main/res/values-bn/strings.xml
index 9b46fb75b..26a70fc1e 100644
--- a/facebook/src/main/res/values-bn/strings.xml
+++ b/facebook/src/main/res/values-bn/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">        </string>
     <string name="com_facebook_share_button_text"> </string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">     %@       :</string>
 </resources>
diff --git a/facebook/src/main/res/values-cs/strings.xml b/facebook/src/main/res/values-cs/strings.xml
index cf6dde3e1..45cd6c263 100644
--- a/facebook/src/main/res/values-cs/strings.xml
+++ b/facebook/src/main/res/values-cs/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Pi stahovn obrzku dolo k neekan chyb.</string>
     <string name="com_facebook_share_button_text">Sdlet</string>
     <string name="com_facebook_send_button_text">Odeslat</string>
+    <string name="com_facebook_device_auth_instructions">Pejdte ze smartphonu nebo potae na %@ a zadejte tento kd:</string>
 </resources>
diff --git a/facebook/src/main/res/values-da/strings.xml b/facebook/src/main/res/values-da/strings.xml
index 81d321b45..6e12894e4 100644
--- a/facebook/src/main/res/values-da/strings.xml
+++ b/facebook/src/main/res/values-da/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Der opstod en uventet fejl under download af et billede.</string>
     <string name="com_facebook_share_button_text">Del</string>
     <string name="com_facebook_send_button_text">Send</string>
+    <string name="com_facebook_device_auth_instructions">G til %@ p din smartphone eller computer, og indtast denne kode:</string>
 </resources>
diff --git a/facebook/src/main/res/values-de/strings.xml b/facebook/src/main/res/values-de/strings.xml
index 8f6f6edef..ae0fa73e6 100644
--- a/facebook/src/main/res/values-de/strings.xml
+++ b/facebook/src/main/res/values-de/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Unerwarteter Fehler beim Herunterladen eines Bildes.</string>
     <string name="com_facebook_share_button_text">Teilen</string>
     <string name="com_facebook_send_button_text">Senden</string>
+    <string name="com_facebook_device_auth_instructions">Gehe ber dein Smartphone oder deinen Computer zu %@ und gib diesen Code ein:</string>
 </resources>
diff --git a/facebook/src/main/res/values-el/strings.xml b/facebook/src/main/res/values-el/strings.xml
index 8547a29b9..b771b4232 100644
--- a/facebook/src/main/res/values-el/strings.xml
+++ b/facebook/src/main/res/values-el/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">        .</string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">   %@   smartphone         :</string>
 </resources>
diff --git a/facebook/src/main/res/values-es-rES/strings.xml b/facebook/src/main/res/values-es-rES/strings.xml
index 628fb3b8f..a41aed815 100644
--- a/facebook/src/main/res/values-es-rES/strings.xml
+++ b/facebook/src/main/res/values-es-rES/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Error inesperado al descargar una imagen.</string>
     <string name="com_facebook_share_button_text">Compartir</string>
     <string name="com_facebook_send_button_text">Enviar</string>
+    <string name="com_facebook_device_auth_instructions">Visita %@ en tu smartphone o computadora e ingresa este cdigo:</string>
 </resources>
diff --git a/facebook/src/main/res/values-es/strings.xml b/facebook/src/main/res/values-es/strings.xml
index 8583881bb..7dfbf4ab0 100644
--- a/facebook/src/main/res/values-es/strings.xml
+++ b/facebook/src/main/res/values-es/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Se produjo un error inesperado al descargar una imagen.</string>
     <string name="com_facebook_share_button_text">Compartir</string>
     <string name="com_facebook_send_button_text">Enviar</string>
+    <string name="com_facebook_device_auth_instructions">Visita %@ en tu smartphone u ordenador e introduce este cdigo:</string>
 </resources>
diff --git a/facebook/src/main/res/values-fi/strings.xml b/facebook/src/main/res/values-fi/strings.xml
index f0414e2ea..174a7761f 100644
--- a/facebook/src/main/res/values-fi/strings.xml
+++ b/facebook/src/main/res/values-fi/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Odottamaton virhe kuvan palvelimesta lataamisen aikana.</string>
     <string name="com_facebook_share_button_text">Jaa</string>
     <string name="com_facebook_send_button_text">Lhet</string>
+    <string name="com_facebook_device_auth_instructions">Siirry osoitteeseen %@ lypuhelimella tai tietokoneella ja anna seuraava koodi:</string>
 </resources>
diff --git a/facebook/src/main/res/values-fr/strings.xml b/facebook/src/main/res/values-fr/strings.xml
index 3a1428c78..5247f3cdf 100644
--- a/facebook/src/main/res/values-fr/strings.xml
+++ b/facebook/src/main/res/values-fr/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Une erreur inattendue sest produite au moment de tlcharger une image.</string>
     <string name="com_facebook_share_button_text">Partager</string>
     <string name="com_facebook_send_button_text">Envoyer</string>
+    <string name="com_facebook_device_auth_instructions">Rendez-vous sur %@ sur votre smartphone ou votre ordinateur et entrez ce code:</string>
 </resources>
diff --git a/facebook/src/main/res/values-gu/strings.xml b/facebook/src/main/res/values-gu/strings.xml
index 11b6fa85f..32550142b 100644
--- a/facebook/src/main/res/values-gu/strings.xml
+++ b/facebook/src/main/res/values-gu/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">      .</string>
     <string name="com_facebook_share_button_text"> </string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">     %@        :</string>
 </resources>
diff --git a/facebook/src/main/res/values-hi/strings.xml b/facebook/src/main/res/values-hi/strings.xml
index 6395da2e5..0088a75c6 100644
--- a/facebook/src/main/res/values-hi/strings.xml
+++ b/facebook/src/main/res/values-hi/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">       .</string>
     <string name="com_facebook_share_button_text"> </string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">     %@      :</string>
 </resources>
diff --git a/facebook/src/main/res/values-hr/strings.xml b/facebook/src/main/res/values-hr/strings.xml
index dbe469a53..25d909b28 100644
--- a/facebook/src/main/res/values-hr/strings.xml
+++ b/facebook/src/main/res/values-hr/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Prilikom preuzimanja slike dolo je do neoekivane pogreke.</string>
     <string name="com_facebook_share_button_text">Dijeli</string>
     <string name="com_facebook_send_button_text">Poalji</string>
+    <string name="com_facebook_device_auth_instructions">Posjetite %@ na pametnom telefonu ili raunalu i unesite ovaj kd:</string>
 </resources>
diff --git a/facebook/src/main/res/values-hu/strings.xml b/facebook/src/main/res/values-hu/strings.xml
index fac7ae504..35b1d0dfc 100644
--- a/facebook/src/main/res/values-hu/strings.xml
+++ b/facebook/src/main/res/values-hu/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Vratlan hiba trtnt egy kp betltse kzben.</string>
     <string name="com_facebook_share_button_text">Megoszts</string>
     <string name="com_facebook_send_button_text">Klds</string>
+    <string name="com_facebook_device_auth_instructions">Keresd fel a(z) %@ oldalt a telefonodrl vagy szmtgprl, s rd be a kvetkez kdot:</string>
 </resources>
diff --git a/facebook/src/main/res/values-id/strings.xml b/facebook/src/main/res/values-id/strings.xml
index b52c7972e..ba8d27bcc 100644
--- a/facebook/src/main/res/values-id/strings.xml
+++ b/facebook/src/main/res/values-id/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Kesalahan yang tidak diharapkan saat mengunduh gambar.</string>
     <string name="com_facebook_share_button_text">Berbagi</string>
     <string name="com_facebook_send_button_text">Kirim</string>
+    <string name="com_facebook_device_auth_instructions">Buka %@ dari smartphone Anda atau komputer dan masukkan kode ini:</string>
 </resources>
diff --git a/facebook/src/main/res/values-it/strings.xml b/facebook/src/main/res/values-it/strings.xml
index 0c943b035..170fad349 100644
--- a/facebook/src/main/res/values-it/strings.xml
+++ b/facebook/src/main/res/values-it/strings.xml
@@ -38,4 +38,5 @@
         caricamento di un\'immagine.</string>
     <string name="com_facebook_share_button_text">Condividi</string>
     <string name="com_facebook_send_button_text">Invia</string>
+    <string name="com_facebook_device_auth_instructions">Accedi a %@ nel tuo smartphone o computer e inserisci questo codice:</string>
 </resources>
diff --git a/facebook/src/main/res/values-ja/strings.xml b/facebook/src/main/res/values-ja/strings.xml
index 72993768b..e9895e50e 100644
--- a/facebook/src/main/res/values-ja/strings.xml
+++ b/facebook/src/main/res/values-ja/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error"></string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">%@</string>
 </resources>
diff --git a/facebook/src/main/res/values-kn/strings.xml b/facebook/src/main/res/values-kn/strings.xml
index ccda2eed9..e95d4b409 100644
--- a/facebook/src/main/res/values-kn/strings.xml
+++ b/facebook/src/main/res/values-kn/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">     .</string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">     %@        :</string>
 </resources>
diff --git a/facebook/src/main/res/values-ko/strings.xml b/facebook/src/main/res/values-ko/strings.xml
index fe4bf371e..293f0239a 100644
--- a/facebook/src/main/res/values-ko/strings.xml
+++ b/facebook/src/main/res/values-ko/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">      .</string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">  %@     .</string>
 </resources>
diff --git a/facebook/src/main/res/values-ml/strings.xml b/facebook/src/main/res/values-ml/strings.xml
index 60d537c59..5a304a369 100644
--- a/facebook/src/main/res/values-ml/strings.xml
+++ b/facebook/src/main/res/values-ml/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">    .</string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">    %@    :</string>
 </resources>
diff --git a/facebook/src/main/res/values-mr/strings.xml b/facebook/src/main/res/values-mr/strings.xml
index 786b0ea98..55383f985 100644
--- a/facebook/src/main/res/values-mr/strings.xml
+++ b/facebook/src/main/res/values-mr/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">    .</string>
     <string name="com_facebook_share_button_text"> </string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">     %@        :</string>
 </resources>
diff --git a/facebook/src/main/res/values-nb/strings.xml b/facebook/src/main/res/values-nb/strings.xml
index 0e39cc0b3..e32f25ea7 100644
--- a/facebook/src/main/res/values-nb/strings.xml
+++ b/facebook/src/main/res/values-nb/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Det oppstod en uventet feil ved nedlasting av et bilde.</string>
     <string name="com_facebook_share_button_text">Del</string>
     <string name="com_facebook_send_button_text">Send</string>
+    <string name="com_facebook_device_auth_instructions">G til %@ p smarttelefonen eller datamaskinen din, og oppgi denne koden:</string>
 </resources>
diff --git a/facebook/src/main/res/values-nl/strings.xml b/facebook/src/main/res/values-nl/strings.xml
index 60f198139..5bd975f03 100644
--- a/facebook/src/main/res/values-nl/strings.xml
+++ b/facebook/src/main/res/values-nl/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Onverwachte fout tijdens het downloaden van een afbeelding.</string>
     <string name="com_facebook_share_button_text">Delen</string>
     <string name="com_facebook_send_button_text">Verzenden</string>
+    <string name="com_facebook_device_auth_instructions">Ga op je smartphone of computer naar %@ en voer deze code in:</string>
 </resources>
diff --git a/facebook/src/main/res/values-pa/strings.xml b/facebook/src/main/res/values-pa/strings.xml
index 333626cfb..ed15cdab4 100644
--- a/facebook/src/main/res/values-pa/strings.xml
+++ b/facebook/src/main/res/values-pa/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">         </string>
     <string name="com_facebook_share_button_text"> </string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">    \' %@        :</string>
 </resources>
diff --git a/facebook/src/main/res/values-pl/strings.xml b/facebook/src/main/res/values-pl/strings.xml
index 22e04826b..5ee1ccbdf 100644
--- a/facebook/src/main/res/values-pl/strings.xml
+++ b/facebook/src/main/res/values-pl/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Nieoczekiwany bd podczas pobierania obrazu.</string>
     <string name="com_facebook_share_button_text">Udostpnij</string>
     <string name="com_facebook_send_button_text">Wylij</string>
+    <string name="com_facebook_device_auth_instructions">Przejd do %@ na smartfonie lub komputerze i wprowad ten kod:</string>
 </resources>
diff --git a/facebook/src/main/res/values-pt-rPT/strings.xml b/facebook/src/main/res/values-pt-rPT/strings.xml
index 2ffea467d..99a240396 100644
--- a/facebook/src/main/res/values-pt-rPT/strings.xml
+++ b/facebook/src/main/res/values-pt-rPT/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Ocorreu um erro inesperado ao descarregar uma imagem.</string>
     <string name="com_facebook_share_button_text">Partilhar</string>
     <string name="com_facebook_send_button_text">Enviar</string>
+    <string name="com_facebook_device_auth_instructions">Visita %@ no teu smartphone ou computador e insere este cdigo:</string>
 </resources>
diff --git a/facebook/src/main/res/values-pt/strings.xml b/facebook/src/main/res/values-pt/strings.xml
index 75dd91815..0c4c4902d 100644
--- a/facebook/src/main/res/values-pt/strings.xml
+++ b/facebook/src/main/res/values-pt/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Erro inesperado ao baixar uma imagem.</string>
     <string name="com_facebook_share_button_text">Compartilhar</string>
     <string name="com_facebook_send_button_text">Envio</string>
+    <string name="com_facebook_device_auth_instructions">Acesse %@ no seu smartphone ou computador e insira este cdigo:</string>
 </resources>
diff --git a/facebook/src/main/res/values-ru/strings.xml b/facebook/src/main/res/values-ru/strings.xml
index a0d33b755..9b979802c 100644
--- a/facebook/src/main/res/values-ru/strings.xml
+++ b/facebook/src/main/res/values-ru/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">     .</string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions"> %@         :</string>
 </resources>
diff --git a/facebook/src/main/res/values-sk/strings.xml b/facebook/src/main/res/values-sk/strings.xml
index ececc84de..1924543a7 100644
--- a/facebook/src/main/res/values-sk/strings.xml
+++ b/facebook/src/main/res/values-sk/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Pri sahovan obrzka sa vyskytla neoakvan chyba.</string>
     <string name="com_facebook_share_button_text">Zdiea</string>
     <string name="com_facebook_send_button_text">Odosla</string>
+    <string name="com_facebook_device_auth_instructions">Navtvte %@ v smartfne alebo potai a zadajte tento kd:</string>
 </resources>
diff --git a/facebook/src/main/res/values-sv/strings.xml b/facebook/src/main/res/values-sv/strings.xml
index b34d73b66..2d83109bf 100644
--- a/facebook/src/main/res/values-sv/strings.xml
+++ b/facebook/src/main/res/values-sv/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Ovntat fel vid hmtning av en bild.</string>
     <string name="com_facebook_share_button_text">Dela</string>
     <string name="com_facebook_send_button_text">Skicka</string>
+    <string name="com_facebook_device_auth_instructions">Besk %@ p din smartphone eller dator och ange den hr koden:</string>
 </resources>
diff --git a/facebook/src/main/res/values-ta/strings.xml b/facebook/src/main/res/values-ta/strings.xml
index 95847eaa9..e15ba007d 100644
--- a/facebook/src/main/res/values-ta/strings.xml
+++ b/facebook/src/main/res/values-ta/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">    .</string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">    %@  ,   :</string>
 </resources>
diff --git a/facebook/src/main/res/values-te/strings.xml b/facebook/src/main/res/values-te/strings.xml
index 6c18bdcfa..d31dff43f 100644
--- a/facebook/src/main/res/values-te/strings.xml
+++ b/facebook/src/main/res/values-te/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">     .</string>
     <string name="com_facebook_share_button_text"> </string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions">    %@ ,    :</string>
 </resources>
diff --git a/facebook/src/main/res/values-th/strings.xml b/facebook/src/main/res/values-th/strings.xml
index c865963ca..3ae8b30fa 100644
--- a/facebook/src/main/res/values-th/strings.xml
+++ b/facebook/src/main/res/values-th/strings.xml
@@ -36,4 +36,6 @@
     <string name="com_facebook_image_download_unknown_error"></string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions"> %@  :</string>
+
 </resources>
diff --git a/facebook/src/main/res/values-tl/strings.xml b/facebook/src/main/res/values-tl/strings.xml
index 4ca5557e2..478329b39 100644
--- a/facebook/src/main/res/values-tl/strings.xml
+++ b/facebook/src/main/res/values-tl/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Hindi inaasahang error habang dina-download ang imahe.</string>
     <string name="com_facebook_share_button_text">Ibahagi</string>
     <string name="com_facebook_send_button_text">Ipadala</string>
+    <string name="com_facebook_device_auth_instructions">Puntahan ang %@ sa iyong smartphone o computer at ilagay ang code na ito:</string>
 </resources>
diff --git a/facebook/src/main/res/values-tr/strings.xml b/facebook/src/main/res/values-tr/strings.xml
index 56d0203e1..2aa1bdce9 100644
--- a/facebook/src/main/res/values-tr/strings.xml
+++ b/facebook/src/main/res/values-tr/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Grsel indirilirken beklenmeyen hata.</string>
     <string name="com_facebook_share_button_text">Payla</string>
     <string name="com_facebook_send_button_text">Gnder</string>
+    <string name="com_facebook_device_auth_instructions">Akll telefonunda veya bilgisayarnda %@ adresine git ve bu kodu gir:</string>
 </resources>
diff --git a/facebook/src/main/res/values-vi/strings.xml b/facebook/src/main/res/values-vi/strings.xml
index 6d90625ed..35cedacae 100644
--- a/facebook/src/main/res/values-vi/strings.xml
+++ b/facebook/src/main/res/values-vi/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Li bt ng khi ti nh xung.</string>
     <string name="com_facebook_share_button_text">Chia s</string>
     <string name="com_facebook_send_button_text">Gi</string>
+    <string name="com_facebook_device_auth_instructions">Truy cp %@ trn in thoi thng minh hoc my tnh v nhp m sau:</string>
 </resources>
diff --git a/facebook/src/main/res/values-zh-rCN/strings.xml b/facebook/src/main/res/values-zh-rCN/strings.xml
index 148020fbf..708e677ab 100644
--- a/facebook/src/main/res/values-zh-rCN/strings.xml
+++ b/facebook/src/main/res/values-zh-rCN/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error"></string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions"> %@</string>
 </resources>
diff --git a/facebook/src/main/res/values-zh-rHK/strings.xml b/facebook/src/main/res/values-zh-rHK/strings.xml
index b233194a6..857bbdd69 100644
--- a/facebook/src/main/res/values-zh-rHK/strings.xml
+++ b/facebook/src/main/res/values-zh-rHK/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error"></string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions"> %@ </string>
 </resources>
diff --git a/facebook/src/main/res/values-zh-rTW/strings.xml b/facebook/src/main/res/values-zh-rTW/strings.xml
index 3e6b7e7b2..dc798ed98 100644
--- a/facebook/src/main/res/values-zh-rTW/strings.xml
+++ b/facebook/src/main/res/values-zh-rTW/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error"></string>
     <string name="com_facebook_share_button_text"></string>
     <string name="com_facebook_send_button_text"></string>
+    <string name="com_facebook_device_auth_instructions"> %@</string>
 </resources>
diff --git a/facebook/src/main/res/values/dimens.xml b/facebook/src/main/res/values/dimens.xml
new file mode 100644
index 000000000..5ae0ed683
--- /dev/null
+++ b/facebook/src/main/res/values/dimens.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
+
+    You are hereby granted a non-exclusive, worldwide, royalty-free license to use,
+    copy, modify, and distribute this software in source code or binary form for use
+    in connection with the web services and APIs provided by Facebook.
+
+    As with any software that integrates with the Facebook platform, your use of
+    this software is subject to the Facebook Developer Principles and Policies
+    [http://developers.facebook.com/policy/]. This copyright notice shall be
+    included in all copies or substantial portions of the software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+    COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+    IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+-->
+
+<resources>
+    <dimen name="com_facebook_auth_dialog_corner_radius">2dp</dimen>
+    <!--Oversized radius for making sure that when two frames are overlayed the button
+    one does not stick out-->
+    <dimen name="com_facebook_auth_dialog_corner_radius_oversized">4dp</dimen>
+    <dimen name="com_facebook_button_corner_radius">2dp</dimen>
+</resources>
diff --git a/facebook/src/main/res/values/strings.xml b/facebook/src/main/res/values/strings.xml
index 918adbd3c..2c7d8a066 100644
--- a/facebook/src/main/res/values/strings.xml
+++ b/facebook/src/main/res/values/strings.xml
@@ -36,4 +36,5 @@
     <string name="com_facebook_image_download_unknown_error">Unexpected error while downloading an image.</string>
     <string name="com_facebook_share_button_text">Share</string>
     <string name="com_facebook_send_button_text">Send</string>
+    <string name="com_facebook_device_auth_instructions">Visit &lt;b&gt;facebook.com/device&lt;/b&gt;&lt;br /&gt;on your smartphone or computer&lt;br /&gt;and enter this code</string>
 </resources>
diff --git a/facebook/src/main/res/values/styles.xml b/facebook/src/main/res/values/styles.xml
index 77cbc1ee0..b7824d208 100644
--- a/facebook/src/main/res/values/styles.xml
+++ b/facebook/src/main/res/values/styles.xml
@@ -21,6 +21,7 @@
 
 <resources xmlns:android="http://schemas.android.com/apk/res/android">
     <color name="com_facebook_blue">#3B5998</color>
+    <color name="com_facebook_messenger_blue">#0084ff</color>
 
     <dimen name="com_facebook_likeview_text_size">11.0sp</dimen>
     <color name="com_facebook_likeview_text_color">#6a7180</color>
@@ -50,24 +51,30 @@
 
     <dimen name="com_facebook_tooltip_horizontal_padding">10dp</dimen>
 
+    <color name="com_facebook_device_auth_text">#797E87</color>
+
     <style name="tooltip_bubble_text">
-	    <item name="android:textColor">@android:color/white</item>
-	    <item name="android:gravity">left</item>
-	    <item name="android:textSize">12sp</item>
-	    <item name="android:shadowDy">-1</item>
-	    <item name="android:shadowRadius">0.25</item>
-	    <item name="android:shadowColor">#40000000</item>
+        <item name="android:textColor">@android:color/white</item>
+        <item name="android:gravity">left</item>
+        <item name="android:textSize">12sp</item>
+        <item name="android:shadowDy">-1</item>
+        <item name="android:shadowRadius">0.25</item>
+        <item name="android:shadowColor">#40000000</item>
     </style>
 
     <color name="com_facebook_button_background_color">#415dae</color>
+    <color name="com_facebook_button_background_color_focused">#FFFFFe</color>
+    <color name="com_facebook_button_background_color_focused_disabled">#84878c</color>
+    <color name="com_facebook_button_background_color_selected">#7c8fc8</color>
     <color name="com_facebook_button_background_color_disabled">#bdc1c9</color>
     <color name="com_facebook_button_background_color_pressed">#2f477a</color>
-    <color name="com_facebook_button_like_background_color_selected">#7c8fc8</color>
     <color name="com_facebook_button_login_silver_background_color">#f4f6f8</color>
     <color name="com_facebook_button_login_silver_background_color_pressed">#e9eaf0</color>
-    <color name="com_facebook_button_send_background_color">#0084ff</color>
+    <color name="com_facebook_button_send_background_color">@color/com_facebook_messenger_blue</color>
     <color name="com_facebook_button_send_background_color_pressed">#006fff</color>
 
+    <color name="com_facebook_button_border_color_focused">#dedee6</color>
+
     <style name="com_facebook_button" parent="@android:style/Widget.Button">
         <item name="android:background">@drawable/com_facebook_button_background</item>
         <item name="android:drawablePadding">6dp</item>
@@ -76,7 +83,7 @@
         <item name="android:paddingLeft">8dp</item>
         <item name="android:paddingRight">8dp</item>
         <item name="android:paddingTop">5dp</item>
-        <item name="android:textColor">#ffffff</item>
+        <item name="android:textColor">@color/com_facebook_button_text_color</item>
         <item name="android:textSize">14.0dp</item>
     </style>
 
@@ -96,8 +103,9 @@
 
     <style name="com_facebook_button_send" parent="com_facebook_button">
         <item name="android:background">@drawable/com_facebook_button_send_background</item>
-        <item name="android:drawableLeft">@drawable/com_facebook_button_send_icon</item>
+        <item name="android:drawableLeft">@drawable/com_facebook_send_button_icon</item>
         <item name="android:text">@string/com_facebook_send_button_text</item>
+        <item name="android:textColor">@color/com_facebook_send_button_text_color</item>
     </style>
 
     <style name="com_facebook_button_share" parent="com_facebook_button">
@@ -105,4 +113,11 @@
         <item name="android:text">@string/com_facebook_share_button_text</item>
     </style>
 
+    <style name="com_facebook_auth_dialog" parent="android:style/Theme.Dialog">
+        <item name="android:windowIsTranslucent">true</item>
+        <item name="android:windowBackground">@android:color/transparent</item>
+        <item name="android:windowNoTitle">true</item>
+        <item name="android:windowIsFloating">true</item>
+    </style>
+
 </resources>
diff --git a/samples/HelloFacebookSample/build.gradle b/samples/HelloFacebookSample/build.gradle
index 41125c44d..8ba946d53 100644
--- a/samples/HelloFacebookSample/build.gradle
+++ b/samples/HelloFacebookSample/build.gradle
@@ -24,4 +24,13 @@ android {
             res.srcDirs = ['res']
         }
     }
+
+    splits {
+        abi {
+            enable true
+            reset()
+            include 'armeabi', 'armeabi-v7a', 'x86'
+            universalApk true
+        }
+    }
 }
diff --git a/samples/Iconicus/build.gradle b/samples/Iconicus/build.gradle
index d22bc7484..2c95ebc24 100644
--- a/samples/Iconicus/build.gradle
+++ b/samples/Iconicus/build.gradle
@@ -39,4 +39,13 @@ android {
             res.srcDirs = ['res']
         }
     }
+
+    splits {
+        abi {
+            enable true
+            reset()
+            include 'armeabi', 'armeabi-v7a', 'x86'
+            universalApk true
+        }
+    }
 }
diff --git a/samples/MessengerSendSample/build.gradle b/samples/MessengerSendSample/build.gradle
index 8aa7226d9..b1a0545e9 100644
--- a/samples/MessengerSendSample/build.gradle
+++ b/samples/MessengerSendSample/build.gradle
@@ -7,7 +7,7 @@ android {
     defaultConfig {
         applicationId "com.facebook.samples.messenger.send"
         minSdkVersion Integer.parseInt(project.ANDROID_BUILD_MIN_SDK_VERSION)
-        targetSdkVersion 21
+        targetSdkVersion Integer.parseInt(project.ANDROID_BUILD_TARGET_SDK_VERSION)
         versionCode 1
         versionName "0.1"
     }
@@ -36,10 +36,18 @@ android {
             keyPassword "android"
         }
     }
+
+    splits {
+        abi {
+            enable true
+            reset()
+            include 'armeabi', 'armeabi-v7a', 'x86'
+            universalApk true
+        }
+    }
 }
 
 dependencies {
     compile project(':facebook')
     compile('com.android.support:appcompat-v7:21.0.3')
-    compile 'com.parse.bolts:bolts-android:1.1.4'
 }
diff --git a/samples/RPSSample/build.gradle b/samples/RPSSample/build.gradle
index 41125c44d..8ba946d53 100644
--- a/samples/RPSSample/build.gradle
+++ b/samples/RPSSample/build.gradle
@@ -24,4 +24,13 @@ android {
             res.srcDirs = ['res']
         }
     }
+
+    splits {
+        abi {
+            enable true
+            reset()
+            include 'armeabi', 'armeabi-v7a', 'x86'
+            universalApk true
+        }
+    }
 }
diff --git a/samples/Scrumptious/build.gradle b/samples/Scrumptious/build.gradle
index 41125c44d..8ba946d53 100644
--- a/samples/Scrumptious/build.gradle
+++ b/samples/Scrumptious/build.gradle
@@ -24,4 +24,13 @@ android {
             res.srcDirs = ['res']
         }
     }
+
+    splits {
+        abi {
+            enable true
+            reset()
+            include 'armeabi', 'armeabi-v7a', 'x86'
+            universalApk true
+        }
+    }
 }
diff --git a/samples/ShareIt/build.gradle b/samples/ShareIt/build.gradle
index 33186a885..3288f92db 100644
--- a/samples/ShareIt/build.gradle
+++ b/samples/ShareIt/build.gradle
@@ -9,7 +9,7 @@ dependencies {
     // In order to test a specific version published on maven, comment out the project compile
     // directive and and comment this line and update to the specific version.
     // compile 'com.facebook.android:facebook-android-sdk:4.0.1'
-    compile 'com.android.support:appcompat-v7:22+'
+    compile 'com.android.support:appcompat-v7:23+'
 }
 
 android {
@@ -40,4 +40,13 @@ android {
             res.srcDirs = ['res']
         }
     }
+
+    splits {
+        abi {
+            enable true
+            reset()
+            include 'armeabi', 'armeabi-v7a', 'x86'
+            universalApk true
+        }
+    }
 }
diff --git a/samples/SwitchUserSample/build.gradle b/samples/SwitchUserSample/build.gradle
index 1085e758b..a34022f03 100644
--- a/samples/SwitchUserSample/build.gradle
+++ b/samples/SwitchUserSample/build.gradle
@@ -25,4 +25,13 @@ android {
             res.srcDirs = ['res']
         }
     }
+
+    splits {
+        abi {
+            enable true
+            reset()
+            include 'armeabi', 'armeabi-v7a', 'x86'
+            universalApk true
+        }
+    }
 }
